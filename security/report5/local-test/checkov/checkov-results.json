{"check_type": "dockerfile", "results": {"passed_checks": [{"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [8, "\n"], [9, "# Build args for frontend environment variables\n"], [10, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [11, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [12, "\n"], [13, "WORKDIR /app/frontend\n"], [14, "\n"], [15, "# Copy frontend package files\n"], [16, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [17, "\n"], [18, "# Install frontend dependencies\n"], [19, "RUN bun install --frozen-lockfile\n"], [20, "\n"], [21, "# Copy frontend source\n"], [22, "COPY frontend/ .\n"], [23, "\n"], [24, "# Build frontend (outputs to /app/frontend/dist)\n"], [25, "RUN bun run build\n"], [26, "\n"], [27, "# =============================================================================\n"], [28, "# Stage 2: Build EcoLocker Frontend\n"], [29, "# =============================================================================\n"], [30, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [31, "\n"], [32, "WORKDIR /app/ecolocker\n"], [33, "\n"], [34, "# Copy ecolocker package files\n"], [35, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [36, "\n"], [37, "# Install ecolocker dependencies\n"], [38, "RUN bun install --frozen-lockfile\n"], [39, "\n"], [40, "# Copy ecolocker source\n"], [41, "COPY ecolocker/ .\n"], [42, "\n"], [43, "# Build ecolocker (vite build defaults to production mode)\n"], [44, "RUN bun run build\n"], [45, "\n"], [46, "# =============================================================================\n"], [47, "# Stage 3: Build Backend\n"], [48, "# =============================================================================\n"], [49, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [50, "\n"], [51, "WORKDIR /app/backend\n"], [52, "\n"], [53, "# Copy backend package files\n"], [54, "COPY backend/package.json backend/bun.lockb* ./\n"], [55, "\n"], [56, "# Install backend dependencies\n"], [57, "RUN bun install --frozen-lockfile\n"], [58, "\n"], [59, "# Copy backend source\n"], [60, "COPY backend/ .\n"], [61, "\n"], [62, "# =============================================================================\n"], [63, "# Stage 4: Production Runtime\n"], [64, "# =============================================================================\n"], [65, "FROM oven/bun:1.2.5-alpine AS production\n"], [66, "\n"], [67, "WORKDIR /app\n"], [68, "\n"], [69, "# Update system packages to get security patches\n"], [70, "RUN apk update && apk upgrade --no-cache\n"], [71, "\n"], [72, "# Create non-root user for security\n"], [73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"], [75, "\n"], [76, "# Copy backend source and config\n"], [77, "COPY --from=backend-builder /app/backend/src ./src\n"], [78, "COPY --from=backend-builder /app/backend/package.json ./\n"], [79, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [80, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [81, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [82, "\n"], [83, "# Install production-only dependencies, remove dev tool binaries and Go binaries\n"], [84, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [88, "\n"], [89, "# Copy frontend build output to be served by backend\n"], [90, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [91, "\n"], [92, "# Copy ecolocker build output under public/ecolocker/\n"], [93, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [94, "\n"], [95, "# Copy entrypoint script\n"], [96, "COPY entrypoint.sh ./entrypoint.sh\n"], [97, "\n"], [98, "# Remove any remaining Go binaries from entire image (Trivy CVE-2024-24790, CVE-2023-39325)\n"], [99, "# Go binaries may exist in base image tools, not just node_modules\n"], [100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [101, "\n"], [102, "# Create data directory for SQLite and make entrypoint executable\n"], [103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [104, "\n"], [105, "# Switch to non-root user\n"], [106, "USER ecoplate\n"], [107, "\n"], [108, "# Expose port\n"], [109, "EXPOSE 3000\n"], [110, "\n"], [111, "# Health check\n"], [112, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [113, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [114, "\n"], [115, "# Start with entrypoint (runs migration + seed if needed, then starts server)\n"], [116, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 116], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 64, "endline": 64, "content": "FROM oven/bun:1.2.5-alpine AS production\n", "value": "oven/bun:1.2.5-alpine AS production"}]}, "code_block": [[65, "FROM oven/bun:1.2.5-alpine AS production\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [65, 65], "resource": "/Dockerfile.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [8, "\n"], [9, "# Build args for frontend environment variables\n"], [10, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [11, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [12, "\n"], [13, "WORKDIR /app/frontend\n"], [14, "\n"], [15, "# Copy frontend package files\n"], [16, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [17, "\n"], [18, "# Install frontend dependencies\n"], [19, "RUN bun install --frozen-lockfile\n"], [20, "\n"], [21, "# Copy frontend source\n"], [22, "COPY frontend/ .\n"], [23, "\n"], [24, "# Build frontend (outputs to /app/frontend/dist)\n"], [25, "RUN bun run build\n"], [26, "\n"], [27, "# =============================================================================\n"], [28, "# Stage 2: Build EcoLocker Frontend\n"], [29, "# =============================================================================\n"], [30, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [31, "\n"], [32, "WORKDIR /app/ecolocker\n"], [33, "\n"], [34, "# Copy ecolocker package files\n"], [35, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [36, "\n"], [37, "# Install ecolocker dependencies\n"], [38, "RUN bun install --frozen-lockfile\n"], [39, "\n"], [40, "# Copy ecolocker source\n"], [41, "COPY ecolocker/ .\n"], [42, "\n"], [43, "# Build ecolocker (vite build defaults to production mode)\n"], [44, "RUN bun run build\n"], [45, "\n"], [46, "# =============================================================================\n"], [47, "# Stage 3: Build Backend\n"], [48, "# =============================================================================\n"], [49, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [50, "\n"], [51, "WORKDIR /app/backend\n"], [52, "\n"], [53, "# Copy backend package files\n"], [54, "COPY backend/package.json backend/bun.lockb* ./\n"], [55, "\n"], [56, "# Install backend dependencies\n"], [57, "RUN bun install --frozen-lockfile\n"], [58, "\n"], [59, "# Copy backend source\n"], [60, "COPY backend/ .\n"], [61, "\n"], [62, "# =============================================================================\n"], [63, "# Stage 4: Production Runtime\n"], [64, "# =============================================================================\n"], [65, "FROM oven/bun:1.2.5-alpine AS production\n"], [66, "\n"], [67, "WORKDIR /app\n"], [68, "\n"], [69, "# Update system packages to get security patches\n"], [70, "RUN apk update && apk upgrade --no-cache\n"], [71, "\n"], [72, "# Create non-root user for security\n"], [73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"], [75, "\n"], [76, "# Copy backend source and config\n"], [77, "COPY --from=backend-builder /app/backend/src ./src\n"], [78, "COPY --from=backend-builder /app/backend/package.json ./\n"], [79, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [80, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [81, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [82, "\n"], [83, "# Install production-only dependencies, remove dev tool binaries and Go binaries\n"], [84, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [88, "\n"], [89, "# Copy frontend build output to be served by backend\n"], [90, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [91, "\n"], [92, "# Copy ecolocker build output under public/ecolocker/\n"], [93, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [94, "\n"], [95, "# Copy entrypoint script\n"], [96, "COPY entrypoint.sh ./entrypoint.sh\n"], [97, "\n"], [98, "# Remove any remaining Go binaries from entire image (Trivy CVE-2024-24790, CVE-2023-39325)\n"], [99, "# Go binaries may exist in base image tools, not just node_modules\n"], [100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [101, "\n"], [102, "# Create data directory for SQLite and make entrypoint executable\n"], [103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [104, "\n"], [105, "# Switch to non-root user\n"], [106, "USER ecoplate\n"], [107, "\n"], [108, "# Expose port\n"], [109, "EXPOSE 3000\n"], [110, "\n"], [111, "# Health check\n"], [112, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [113, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [114, "\n"], [115, "# Start with entrypoint (runs migration + seed if needed, then starts server)\n"], [116, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 116], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 105, "endline": 105, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[106, "USER ecoplate\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [106, 106], "resource": "/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_10", "check_name": "Ensure that WORKDIR values are absolute paths", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [8, "\n"], [9, "# Build args for frontend environment variables\n"], [10, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [11, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [12, "\n"], [13, "WORKDIR /app/frontend\n"], [14, "\n"], [15, "# Copy frontend package files\n"], [16, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [17, "\n"], [18, "# Install frontend dependencies\n"], [19, "RUN bun install --frozen-lockfile\n"], [20, "\n"], [21, "# Copy frontend source\n"], [22, "COPY frontend/ .\n"], [23, "\n"], [24, "# Build frontend (outputs to /app/frontend/dist)\n"], [25, "RUN bun run build\n"], [26, "\n"], [27, "# =============================================================================\n"], [28, "# Stage 2: Build EcoLocker Frontend\n"], [29, "# =============================================================================\n"], [30, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [31, "\n"], [32, "WORKDIR /app/ecolocker\n"], [33, "\n"], [34, "# Copy ecolocker package files\n"], [35, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [36, "\n"], [37, "# Install ecolocker dependencies\n"], [38, "RUN bun install --frozen-lockfile\n"], [39, "\n"], [40, "# Copy ecolocker source\n"], [41, "COPY ecolocker/ .\n"], [42, "\n"], [43, "# Build ecolocker (vite build defaults to production mode)\n"], [44, "RUN bun run build\n"], [45, "\n"], [46, "# =============================================================================\n"], [47, "# Stage 3: Build Backend\n"], [48, "# =============================================================================\n"], [49, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [50, "\n"], [51, "WORKDIR /app/backend\n"], [52, "\n"], [53, "# Copy backend package files\n"], [54, "COPY backend/package.json backend/bun.lockb* ./\n"], [55, "\n"], [56, "# Install backend dependencies\n"], [57, "RUN bun install --frozen-lockfile\n"], [58, "\n"], [59, "# Copy backend source\n"], [60, "COPY backend/ .\n"], [61, "\n"], [62, "# =============================================================================\n"], [63, "# Stage 4: Production Runtime\n"], [64, "# =============================================================================\n"], [65, "FROM oven/bun:1.2.5-alpine AS production\n"], [66, "\n"], [67, "WORKDIR /app\n"], [68, "\n"], [69, "# Update system packages to get security patches\n"], [70, "RUN apk update && apk upgrade --no-cache\n"], [71, "\n"], [72, "# Create non-root user for security\n"], [73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"], [75, "\n"], [76, "# Copy backend source and config\n"], [77, "COPY --from=backend-builder /app/backend/src ./src\n"], [78, "COPY --from=backend-builder /app/backend/package.json ./\n"], [79, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [80, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [81, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [82, "\n"], [83, "# Install production-only dependencies, remove dev tool binaries and Go binaries\n"], [84, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [88, "\n"], [89, "# Copy frontend build output to be served by backend\n"], [90, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [91, "\n"], [92, "# Copy ecolocker build output under public/ecolocker/\n"], [93, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [94, "\n"], [95, "# Copy entrypoint script\n"], [96, "COPY entrypoint.sh ./entrypoint.sh\n"], [97, "\n"], [98, "# Remove any remaining Go binaries from entire image (Trivy CVE-2024-24790, CVE-2023-39325)\n"], [99, "# Go binaries may exist in base image tools, not just node_modules\n"], [100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [101, "\n"], [102, "# Create data directory for SQLite and make entrypoint executable\n"], [103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [104, "\n"], [105, "# Switch to non-root user\n"], [106, "USER ecoplate\n"], [107, "\n"], [108, "# Expose port\n"], [109, "EXPOSE 3000\n"], [110, "\n"], [111, "# Health check\n"], [112, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [113, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [114, "\n"], [115, "# Start with entrypoint (runs migration + seed if needed, then starts server)\n"], [116, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 116], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.WorkdirIsAbsolute", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-workdir-values-are-absolute-paths", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [8, "\n"], [9, "# Build args for frontend environment variables\n"], [10, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [11, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [12, "\n"], [13, "WORKDIR /app/frontend\n"], [14, "\n"], [15, "# Copy frontend package files\n"], [16, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [17, "\n"], [18, "# Install frontend dependencies\n"], [19, "RUN bun install --frozen-lockfile\n"], [20, "\n"], [21, "# Copy frontend source\n"], [22, "COPY frontend/ .\n"], [23, "\n"], [24, "# Build frontend (outputs to /app/frontend/dist)\n"], [25, "RUN bun run build\n"], [26, "\n"], [27, "# =============================================================================\n"], [28, "# Stage 2: Build EcoLocker Frontend\n"], [29, "# =============================================================================\n"], [30, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [31, "\n"], [32, "WORKDIR /app/ecolocker\n"], [33, "\n"], [34, "# Copy ecolocker package files\n"], [35, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [36, "\n"], [37, "# Install ecolocker dependencies\n"], [38, "RUN bun install --frozen-lockfile\n"], [39, "\n"], [40, "# Copy ecolocker source\n"], [41, "COPY ecolocker/ .\n"], [42, "\n"], [43, "# Build ecolocker (vite build defaults to production mode)\n"], [44, "RUN bun run build\n"], [45, "\n"], [46, "# =============================================================================\n"], [47, "# Stage 3: Build Backend\n"], [48, "# =============================================================================\n"], [49, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [50, "\n"], [51, "WORKDIR /app/backend\n"], [52, "\n"], [53, "# Copy backend package files\n"], [54, "COPY backend/package.json backend/bun.lockb* ./\n"], [55, "\n"], [56, "# Install backend dependencies\n"], [57, "RUN bun install --frozen-lockfile\n"], [58, "\n"], [59, "# Copy backend source\n"], [60, "COPY backend/ .\n"], [61, "\n"], [62, "# =============================================================================\n"], [63, "# Stage 4: Production Runtime\n"], [64, "# =============================================================================\n"], [65, "FROM oven/bun:1.2.5-alpine AS production\n"], [66, "\n"], [67, "WORKDIR /app\n"], [68, "\n"], [69, "# Update system packages to get security patches\n"], [70, "RUN apk update && apk upgrade --no-cache\n"], [71, "\n"], [72, "# Create non-root user for security\n"], [73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"], [75, "\n"], [76, "# Copy backend source and config\n"], [77, "COPY --from=backend-builder /app/backend/src ./src\n"], [78, "COPY --from=backend-builder /app/backend/package.json ./\n"], [79, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [80, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [81, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [82, "\n"], [83, "# Install production-only dependencies, remove dev tool binaries and Go binaries\n"], [84, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [88, "\n"], [89, "# Copy frontend build output to be served by backend\n"], [90, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [91, "\n"], [92, "# Copy ecolocker build output under public/ecolocker/\n"], [93, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [94, "\n"], [95, "# Copy entrypoint script\n"], [96, "COPY entrypoint.sh ./entrypoint.sh\n"], [97, "\n"], [98, "# Remove any remaining Go binaries from entire image (Trivy CVE-2024-24790, CVE-2023-39325)\n"], [99, "# Go binaries may exist in base image tools, not just node_modules\n"], [100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [101, "\n"], [102, "# Create data directory for SQLite and make entrypoint executable\n"], [103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [104, "\n"], [105, "# Switch to non-root user\n"], [106, "USER ecoplate\n"], [107, "\n"], [108, "# Expose port\n"], [109, "EXPOSE 3000\n"], [110, "\n"], [111, "# Health check\n"], [112, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [113, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [114, "\n"], [115, "# Start with entrypoint (runs migration + seed if needed, then starts server)\n"], [116, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 116], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [8, "\n"], [9, "# Build args for frontend environment variables\n"], [10, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [11, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [12, "\n"], [13, "WORKDIR /app/frontend\n"], [14, "\n"], [15, "# Copy frontend package files\n"], [16, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [17, "\n"], [18, "# Install frontend dependencies\n"], [19, "RUN bun install --frozen-lockfile\n"], [20, "\n"], [21, "# Copy frontend source\n"], [22, "COPY frontend/ .\n"], [23, "\n"], [24, "# Build frontend (outputs to /app/frontend/dist)\n"], [25, "RUN bun run build\n"], [26, "\n"], [27, "# =============================================================================\n"], [28, "# Stage 2: Build EcoLocker Frontend\n"], [29, "# =============================================================================\n"], [30, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [31, "\n"], [32, "WORKDIR /app/ecolocker\n"], [33, "\n"], [34, "# Copy ecolocker package files\n"], [35, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [36, "\n"], [37, "# Install ecolocker dependencies\n"], [38, "RUN bun install --frozen-lockfile\n"], [39, "\n"], [40, "# Copy ecolocker source\n"], [41, "COPY ecolocker/ .\n"], [42, "\n"], [43, "# Build ecolocker (vite build defaults to production mode)\n"], [44, "RUN bun run build\n"], [45, "\n"], [46, "# =============================================================================\n"], [47, "# Stage 3: Build Backend\n"], [48, "# =============================================================================\n"], [49, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [50, "\n"], [51, "WORKDIR /app/backend\n"], [52, "\n"], [53, "# Copy backend package files\n"], [54, "COPY backend/package.json backend/bun.lockb* ./\n"], [55, "\n"], [56, "# Install backend dependencies\n"], [57, "RUN bun install --frozen-lockfile\n"], [58, "\n"], [59, "# Copy backend source\n"], [60, "COPY backend/ .\n"], [61, "\n"], [62, "# =============================================================================\n"], [63, "# Stage 4: Production Runtime\n"], [64, "# =============================================================================\n"], [65, "FROM oven/bun:1.2.5-alpine AS production\n"], [66, "\n"], [67, "WORKDIR /app\n"], [68, "\n"], [69, "# Update system packages to get security patches\n"], [70, "RUN apk update && apk upgrade --no-cache\n"], [71, "\n"], [72, "# Create non-root user for security\n"], [73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"], [75, "\n"], [76, "# Copy backend source and config\n"], [77, "COPY --from=backend-builder /app/backend/src ./src\n"], [78, "COPY --from=backend-builder /app/backend/package.json ./\n"], [79, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [80, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [81, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [82, "\n"], [83, "# Install production-only dependencies, remove dev tool binaries and Go binaries\n"], [84, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [88, "\n"], [89, "# Copy frontend build output to be served by backend\n"], [90, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [91, "\n"], [92, "# Copy ecolocker build output under public/ecolocker/\n"], [93, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [94, "\n"], [95, "# Copy entrypoint script\n"], [96, "COPY entrypoint.sh ./entrypoint.sh\n"], [97, "\n"], [98, "# Remove any remaining Go binaries from entire image (Trivy CVE-2024-24790, CVE-2023-39325)\n"], [99, "# Go binaries may exist in base image tools, not just node_modules\n"], [100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [101, "\n"], [102, "# Create data directory for SQLite and make entrypoint executable\n"], [103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [104, "\n"], [105, "# Switch to non-root user\n"], [106, "USER ecoplate\n"], [107, "\n"], [108, "# Expose port\n"], [109, "EXPOSE 3000\n"], [110, "\n"], [111, "# Health check\n"], [112, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [113, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [114, "\n"], [115, "# Start with entrypoint (runs migration + seed if needed, then starts server)\n"], [116, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 116], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 111, "endline": 112, "content": "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n", "value": "--interval=30s --timeout=10s --start-period=15s --retries=5     CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1"}]}, "code_block": [[112, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [113, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 113], "resource": "/Dockerfile.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 105, "endline": 105, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[106, "USER ecoplate\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [106, 106], "resource": "/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 3, "endline": 3, "content": "FROM python:3.12-slim-bookworm AS production\n", "value": "python:3.12-slim-bookworm AS production"}]}, "code_block": [[4, "FROM python:3.12-slim-bookworm AS production\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [4, 4], "resource": "/recommendation-engine/Dockerfile.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 23, "endline": 23, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[24, "USER ecoplate\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [24, 24], "resource": "/recommendation-engine/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_10", "check_name": "Ensure that WORKDIR values are absolute paths", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.WorkdirIsAbsolute", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-workdir-values-are-absolute-paths", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 29, "endline": 30, "content": "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n", "value": "--interval=30s --timeout=10s --start-period=5s --retries=3     CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1"}]}, "code_block": [[30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [30, 31], "resource": "/recommendation-engine/Dockerfile.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 23, "endline": 23, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[24, "USER ecoplate\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [24, 24], "resource": "/recommendation-engine/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 0, "endline": 0, "content": "FROM nginx:alpine\n", "value": "nginx:alpine"}]}, "code_block": [[1, "FROM nginx:alpine\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 1], "resource": "/deploy/Dockerfile.nginx.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM nginx:alpine\n"], [2, "\n"], [3, "# No third-party modules needed \u2014 using only built-in nginx directives\n"], [4, "# server_tokens off + proxy_hide_header handle Server header\n"], [5, "\n"], [6, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [7, "    CMD wget --no-verbose --tries=1 --spider http://localhost:80/ || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 7], "resource": "/deploy/Dockerfile.nginx.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 5, "endline": 6, "content": "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n    CMD wget --no-verbose --tries=1 --spider http://localhost:80/ || exit 1", "value": "--interval=30s --timeout=5s --retries=3     CMD wget --no-verbose --tries=1 --spider http://localhost:80/ || exit 1"}]}, "code_block": [[6, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [7, "    CMD wget --no-verbose --tries=1 --spider http://localhost:80/ || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [6, 7], "resource": "/deploy/Dockerfile.nginx.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 9, "__endline__": 9}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 9, "__endline__": 9, "resource_type": "ARG", "hash": "2bd8e732282e9b63f3bc0212f56d691ce123c9f475dcf0a96937ecd6981eec8b"}, "evaluated_keys": ["value"]}, "code_block": [[10, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [10, 10], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 10, "__endline__": 10}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 10, "__endline__": 10, "resource_type": "ENV", "hash": "3c4176e7882ca993b7fa9a05361c1c49df5e048afa3d056525403d0cd4d07e45"}, "evaluated_keys": ["value"]}, "code_block": [[11, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [11, 11], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 9, "__endline__": 9}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 9, "__endline__": 9, "resource_type": "ARG", "hash": "2bd8e732282e9b63f3bc0212f56d691ce123c9f475dcf0a96937ecd6981eec8b"}, "evaluated_keys": ["value"]}, "code_block": [[10, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [10, 10], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 10, "__endline__": 10}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 10, "__endline__": 10, "resource_type": "ENV", "hash": "3c4176e7882ca993b7fa9a05361c1c49df5e048afa3d056525403d0cd4d07e45"}, "evaluated_keys": ["value"]}, "code_block": [[11, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [11, 11], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 9, "__endline__": 9}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 9, "__endline__": 9, "resource_type": "ARG", "hash": "2bd8e732282e9b63f3bc0212f56d691ce123c9f475dcf0a96937ecd6981eec8b"}, "evaluated_keys": ["value"]}, "code_block": [[10, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [10, 10], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 10, "__endline__": 10}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 10, "__endline__": 10, "resource_type": "ENV", "hash": "3c4176e7882ca993b7fa9a05361c1c49df5e048afa3d056525403d0cd4d07e45"}, "evaluated_keys": ["value"]}, "code_block": [[11, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [11, 11], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 9, "__endline__": 9}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 9, "__endline__": 9, "resource_type": "ARG", "hash": "2bd8e732282e9b63f3bc0212f56d691ce123c9f475dcf0a96937ecd6981eec8b"}, "evaluated_keys": ["value"]}, "code_block": [[10, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [10, 10], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 10, "__endline__": 10}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 10, "__endline__": 10, "resource_type": "ENV", "hash": "3c4176e7882ca993b7fa9a05361c1c49df5e048afa3d056525403d0cd4d07e45"}, "evaluated_keys": ["value"]}, "code_block": [[11, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [11, 11], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 9, "__endline__": 9}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 9, "__endline__": 9, "resource_type": "ARG", "hash": "2bd8e732282e9b63f3bc0212f56d691ce123c9f475dcf0a96937ecd6981eec8b"}, "evaluated_keys": ["value"]}, "code_block": [[10, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [10, 10], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 10, "__endline__": 10}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 10, "__endline__": 10, "resource_type": "ENV", "hash": "3c4176e7882ca993b7fa9a05361c1c49df5e048afa3d056525403d0cd4d07e45"}, "evaluated_keys": ["value"]}, "code_block": [[11, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [11, 11], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 18, "__endline__": 18, "resource_type": "RUN", "hash": "41494d32132a6a08c10fd2ec6fda997456d5cbbcfc16dfb9ce2843ccbbe7e4ce"}, "evaluated_keys": ["value"]}, "code_block": [[19, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [19, 19], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 24, "__endline__": 24, "resource_type": "RUN", "hash": "5f1762c4296ff4cbb14fc9cc0636116e14bfb342447c940d7005329c997d52ff"}, "evaluated_keys": ["value"]}, "code_block": [[25, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [25, 25], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 37, "__endline__": 37, "resource_type": "RUN", "hash": "d8b833701f0e01143ddbd955a59c69d743dcfbe54c6ccde6501e63bb5fa14007"}, "evaluated_keys": ["value"]}, "code_block": [[38, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [38, 38], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 43, "__endline__": 43, "resource_type": "RUN", "hash": "98c69db6e5cc4c79cf38200c411d7b66f32af6fce00108469eec63388c74462f"}, "evaluated_keys": ["value"]}, "code_block": [[44, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [44, 44], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --frozen-lockfile\n", "value": "bun install --frozen-lockfile", "__startline__": 56, "__endline__": 56, "resource_type": "RUN", "hash": "94d8dcfe74bebd1338541435a817670306c677d243eab6d62569714ec91bda2f"}, "evaluated_keys": ["value"]}, "code_block": [[57, "RUN bun install --frozen-lockfile\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [57, 57], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 69, "__endline__": 69, "resource_type": "RUN", "hash": "56b5b6e730266889540d6fa47e9b3250fe8fb3842ec34e3caf876d8d05617c79"}, "evaluated_keys": ["value"]}, "code_block": [[70, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [70, 70], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 72, "__endline__": 73, "resource_type": "RUN", "hash": "887147eb73431ca4754c3329a26364d1ec25668ddf99548fcac1562a2c62257a"}, "evaluated_keys": ["value"]}, "code_block": [[73, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [74, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [73, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 84, "__endline__": 86, "resource_type": "RUN", "hash": "3636d339cfa452e45aefb0cb5d589c84b6447c404632e82fd07b73f7f03c39b6"}, "evaluated_keys": ["value"]}, "code_block": [[85, "RUN bun install --production && \\\n"], [86, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [87, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [85, 87], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 99, "__endline__": 99, "resource_type": "RUN", "hash": "1ca34e9d935f9e96d586135937bceddccc79e27505b11aea7e7bda0e7dae5650"}, "evaluated_keys": ["value"]}, "code_block": [[100, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ /app/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [100, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 102, "__endline__": 102, "resource_type": "RUN", "hash": "3dead0ffd73c1da1fdfe76cdb2895183369bd0b70ac259acf43e9149aff4de54"}, "evaluated_keys": ["value"]}, "code_block": [[103, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [103, 103], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}], "failed_checks": [{"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "FAILED", "results_configuration": null}, "code_block": [[1, "FROM nginx:alpine\n"], [2, "\n"], [3, "# No third-party modules needed \u2014 using only built-in nginx directives\n"], [4, "# server_tokens off + proxy_hide_header handle Server header\n"], [5, "\n"], [6, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [7, "    CMD wget --no-verbose --tries=1 --spider http://localhost:80/ || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 7], "resource": "/deploy/Dockerfile.nginx.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 252, "failed": 1, "skipped": 0, "parsing_errors": 0, "resource_count": 3, "checkov_version": "3.2.500"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}