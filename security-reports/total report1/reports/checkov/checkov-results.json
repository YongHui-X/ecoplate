{"check_type": "dockerfile", "results": {"passed_checks": [{"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 3, "endline": 3, "content": "FROM python:3.12-slim-bookworm AS production\n", "value": "python:3.12-slim-bookworm AS production"}]}, "code_block": [[4, "FROM python:3.12-slim-bookworm AS production\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [4, 4], "resource": "/recommendation-engine/Dockerfile.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 23, "endline": 23, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[24, "USER ecoplate\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [24, 24], "resource": "/recommendation-engine/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_10", "check_name": "Ensure that WORKDIR values are absolute paths", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.WorkdirIsAbsolute", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-workdir-values-are-absolute-paths", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 29, "endline": 30, "content": "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n", "value": "--interval=30s --timeout=10s --start-period=5s --retries=3     CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1"}]}, "code_block": [[30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [30, 31], "resource": "/recommendation-engine/Dockerfile.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 23, "endline": 23, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[24, "USER ecoplate\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [24, 24], "resource": "/recommendation-engine/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM nginx:alpine\n"], [2, "\n"], [3, "# No third-party modules needed \u2014 using only built-in nginx directives\n"], [4, "# server_tokens off + proxy_hide_header handle Server header\n"], [5, "\n"], [6, "# Configure nginx to run as non-root user (CKV_DOCKER_3)\n"], [7, "# nginx:alpine already has nginx user (uid 101), just need to fix permissions\n"], [8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"], [11, "\n"], [12, "# Switch to non-root user\n"], [13, "USER nginx\n"], [14, "\n"], [15, "# Expose HTTP and HTTPS ports\n"], [16, "EXPOSE 8080 8443\n"], [17, "\n"], [18, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [19, "    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 19], "resource": "/deploy/Dockerfile.nginx.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 0, "endline": 0, "content": "FROM nginx:alpine\n", "value": "nginx:alpine"}]}, "code_block": [[1, "FROM nginx:alpine\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 1], "resource": "/deploy/Dockerfile.nginx.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM nginx:alpine\n"], [2, "\n"], [3, "# No third-party modules needed \u2014 using only built-in nginx directives\n"], [4, "# server_tokens off + proxy_hide_header handle Server header\n"], [5, "\n"], [6, "# Configure nginx to run as non-root user (CKV_DOCKER_3)\n"], [7, "# nginx:alpine already has nginx user (uid 101), just need to fix permissions\n"], [8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"], [11, "\n"], [12, "# Switch to non-root user\n"], [13, "USER nginx\n"], [14, "\n"], [15, "# Expose HTTP and HTTPS ports\n"], [16, "EXPOSE 8080 8443\n"], [17, "\n"], [18, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [19, "    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 19], "resource": "/deploy/Dockerfile.nginx.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 12, "endline": 12, "content": "USER nginx\n", "value": "nginx"}]}, "code_block": [[13, "USER nginx\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [13, 13], "resource": "/deploy/Dockerfile.nginx.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM nginx:alpine\n"], [2, "\n"], [3, "# No third-party modules needed \u2014 using only built-in nginx directives\n"], [4, "# server_tokens off + proxy_hide_header handle Server header\n"], [5, "\n"], [6, "# Configure nginx to run as non-root user (CKV_DOCKER_3)\n"], [7, "# nginx:alpine already has nginx user (uid 101), just need to fix permissions\n"], [8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"], [11, "\n"], [12, "# Switch to non-root user\n"], [13, "USER nginx\n"], [14, "\n"], [15, "# Expose HTTP and HTTPS ports\n"], [16, "EXPOSE 8080 8443\n"], [17, "\n"], [18, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [19, "    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 19], "resource": "/deploy/Dockerfile.nginx.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM nginx:alpine\n"], [2, "\n"], [3, "# No third-party modules needed \u2014 using only built-in nginx directives\n"], [4, "# server_tokens off + proxy_hide_header handle Server header\n"], [5, "\n"], [6, "# Configure nginx to run as non-root user (CKV_DOCKER_3)\n"], [7, "# nginx:alpine already has nginx user (uid 101), just need to fix permissions\n"], [8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"], [11, "\n"], [12, "# Switch to non-root user\n"], [13, "USER nginx\n"], [14, "\n"], [15, "# Expose HTTP and HTTPS ports\n"], [16, "EXPOSE 8080 8443\n"], [17, "\n"], [18, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [19, "    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 19], "resource": "/deploy/Dockerfile.nginx.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 17, "endline": 18, "content": "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1", "value": "--interval=30s --timeout=5s --retries=3     CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"}]}, "code_block": [[18, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [19, "    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [18, 19], "resource": "/deploy/Dockerfile.nginx.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 12, "endline": 12, "content": "USER nginx\n", "value": "nginx"}]}, "code_block": [[13, "USER nginx\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [13, 13], "resource": "/deploy/Dockerfile.nginx.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [8, "\n"], [9, "# Build args for frontend environment variables\n"], [10, "# Note: VITE_ prefixed keys are client-side and intentionally public (embedded in JS bundle)\n"], [11, "# Security is enforced via Google Cloud Console API key restrictions, not secrecy\n"], [12, "# hadolint ignore=DL3044\n"], [13, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [14, "# hadolint ignore=DL3044\n"], [15, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [16, "\n"], [17, "WORKDIR /app/frontend\n"], [18, "\n"], [19, "# Copy frontend package files\n"], [20, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [21, "\n"], [22, "# Install frontend dependencies\n"], [23, "RUN bun install\n"], [24, "\n"], [25, "# Copy frontend source\n"], [26, "COPY frontend/ .\n"], [27, "\n"], [28, "# Build frontend (outputs to /app/frontend/dist)\n"], [29, "RUN bun run build\n"], [30, "\n"], [31, "# =============================================================================\n"], [32, "# Stage 2: Build EcoLocker Frontend\n"], [33, "# =============================================================================\n"], [34, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [35, "\n"], [36, "WORKDIR /app/ecolocker\n"], [37, "\n"], [38, "# Copy ecolocker package files\n"], [39, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [40, "\n"], [41, "# Install ecolocker dependencies\n"], [42, "RUN bun install\n"], [43, "\n"], [44, "# Copy ecolocker source\n"], [45, "COPY ecolocker/ .\n"], [46, "\n"], [47, "# Build ecolocker (vite build defaults to production mode)\n"], [48, "RUN bun run build\n"], [49, "\n"], [50, "# =============================================================================\n"], [51, "# Stage 3: Build Backend\n"], [52, "# =============================================================================\n"], [53, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [54, "\n"], [55, "WORKDIR /app/backend\n"], [56, "\n"], [57, "# Copy backend package files\n"], [58, "COPY backend/package.json backend/bun.lockb* ./\n"], [59, "\n"], [60, "# Install backend dependencies\n"], [61, "RUN bun install\n"], [62, "\n"], [63, "# Copy backend source\n"], [64, "COPY backend/ .\n"], [65, "\n"], [66, "# =============================================================================\n"], [67, "# Stage 4: Production Runtime\n"], [68, "# =============================================================================\n"], [69, "FROM oven/bun:1.2.5-alpine AS production\n"], [70, "\n"], [71, "WORKDIR /app\n"], [72, "\n"], [73, "# Update system packages to get security patches\n"], [74, "RUN apk update && apk upgrade --no-cache\n"], [75, "\n"], [76, "# Create non-root user for security\n"], [77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"], [79, "\n"], [80, "# Copy backend source and config\n"], [81, "COPY --from=backend-builder /app/backend/src ./src\n"], [82, "COPY --from=backend-builder /app/backend/package.json ./\n"], [83, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [84, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [85, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [86, "\n"], [87, "# Install production-only dependencies, then clean all scan-triggering artifacts in same layer\n"], [88, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [89, "# Bun cache contains bun-types docs with example Stripe key (Trivy secret false positive)\n"], [90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"], [94, "\n"], [95, "# Copy frontend build output to be served by backend\n"], [96, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [97, "\n"], [98, "# Copy ecolocker build output under public/ecolocker/\n"], [99, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [100, "\n"], [101, "# Copy entrypoint script\n"], [102, "COPY entrypoint.sh ./entrypoint.sh\n"], [103, "\n"], [104, "# Remove any remaining Go binaries from base image paths\n"], [105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [106, "\n"], [107, "# Create data directory for SQLite and make entrypoint executable\n"], [108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [109, "\n"], [110, "# Switch to non-root user\n"], [111, "USER ecoplate\n"], [112, "\n"], [113, "# Expose port\n"], [114, "EXPOSE 3000\n"], [115, "\n"], [116, "# Health check\n"], [117, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [118, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [119, "\n"], [120, "# Start with entrypoint (runs migration + seed if needed, then starts server)\n"], [121, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 121], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 68, "endline": 68, "content": "FROM oven/bun:1.2.5-alpine AS production\n", "value": "oven/bun:1.2.5-alpine AS production"}]}, "code_block": [[69, "FROM oven/bun:1.2.5-alpine AS production\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [69, 69], "resource": "/Dockerfile.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [8, "\n"], [9, "# Build args for frontend environment variables\n"], [10, "# Note: VITE_ prefixed keys are client-side and intentionally public (embedded in JS bundle)\n"], [11, "# Security is enforced via Google Cloud Console API key restrictions, not secrecy\n"], [12, "# hadolint ignore=DL3044\n"], [13, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [14, "# hadolint ignore=DL3044\n"], [15, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [16, "\n"], [17, "WORKDIR /app/frontend\n"], [18, "\n"], [19, "# Copy frontend package files\n"], [20, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [21, "\n"], [22, "# Install frontend dependencies\n"], [23, "RUN bun install\n"], [24, "\n"], [25, "# Copy frontend source\n"], [26, "COPY frontend/ .\n"], [27, "\n"], [28, "# Build frontend (outputs to /app/frontend/dist)\n"], [29, "RUN bun run build\n"], [30, "\n"], [31, "# =============================================================================\n"], [32, "# Stage 2: Build EcoLocker Frontend\n"], [33, "# =============================================================================\n"], [34, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [35, "\n"], [36, "WORKDIR /app/ecolocker\n"], [37, "\n"], [38, "# Copy ecolocker package files\n"], [39, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [40, "\n"], [41, "# Install ecolocker dependencies\n"], [42, "RUN bun install\n"], [43, "\n"], [44, "# Copy ecolocker source\n"], [45, "COPY ecolocker/ .\n"], [46, "\n"], [47, "# Build ecolocker (vite build defaults to production mode)\n"], [48, "RUN bun run build\n"], [49, "\n"], [50, "# =============================================================================\n"], [51, "# Stage 3: Build Backend\n"], [52, "# =============================================================================\n"], [53, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [54, "\n"], [55, "WORKDIR /app/backend\n"], [56, "\n"], [57, "# Copy backend package files\n"], [58, "COPY backend/package.json backend/bun.lockb* ./\n"], [59, "\n"], [60, "# Install backend dependencies\n"], [61, "RUN bun install\n"], [62, "\n"], [63, "# Copy backend source\n"], [64, "COPY backend/ .\n"], [65, "\n"], [66, "# =============================================================================\n"], [67, "# Stage 4: Production Runtime\n"], [68, "# =============================================================================\n"], [69, "FROM oven/bun:1.2.5-alpine AS production\n"], [70, "\n"], [71, "WORKDIR /app\n"], [72, "\n"], [73, "# Update system packages to get security patches\n"], [74, "RUN apk update && apk upgrade --no-cache\n"], [75, "\n"], [76, "# Create non-root user for security\n"], [77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"], [79, "\n"], [80, "# Copy backend source and config\n"], [81, "COPY --from=backend-builder /app/backend/src ./src\n"], [82, "COPY --from=backend-builder /app/backend/package.json ./\n"], [83, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [84, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [85, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [86, "\n"], [87, "# Install production-only dependencies, then clean all scan-triggering artifacts in same layer\n"], [88, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [89, "# Bun cache contains bun-types docs with example Stripe key (Trivy secret false positive)\n"], [90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"], [94, "\n"], [95, "# Copy frontend build output to be served by backend\n"], [96, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [97, "\n"], [98, "# Copy ecolocker build output under public/ecolocker/\n"], [99, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [100, "\n"], [101, "# Copy entrypoint script\n"], [102, "COPY entrypoint.sh ./entrypoint.sh\n"], [103, "\n"], [104, "# Remove any remaining Go binaries from base image paths\n"], [105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [106, "\n"], [107, "# Create data directory for SQLite and make entrypoint executable\n"], [108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [109, "\n"], [110, "# Switch to non-root user\n"], [111, "USER ecoplate\n"], [112, "\n"], [113, "# Expose port\n"], [114, "EXPOSE 3000\n"], [115, "\n"], [116, "# Health check\n"], [117, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [118, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [119, "\n"], [120, "# Start with entrypoint (runs migration + seed if needed, then starts server)\n"], [121, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 121], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 110, "endline": 110, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[111, "USER ecoplate\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [111, 111], "resource": "/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_10", "check_name": "Ensure that WORKDIR values are absolute paths", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [8, "\n"], [9, "# Build args for frontend environment variables\n"], [10, "# Note: VITE_ prefixed keys are client-side and intentionally public (embedded in JS bundle)\n"], [11, "# Security is enforced via Google Cloud Console API key restrictions, not secrecy\n"], [12, "# hadolint ignore=DL3044\n"], [13, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [14, "# hadolint ignore=DL3044\n"], [15, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [16, "\n"], [17, "WORKDIR /app/frontend\n"], [18, "\n"], [19, "# Copy frontend package files\n"], [20, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [21, "\n"], [22, "# Install frontend dependencies\n"], [23, "RUN bun install\n"], [24, "\n"], [25, "# Copy frontend source\n"], [26, "COPY frontend/ .\n"], [27, "\n"], [28, "# Build frontend (outputs to /app/frontend/dist)\n"], [29, "RUN bun run build\n"], [30, "\n"], [31, "# =============================================================================\n"], [32, "# Stage 2: Build EcoLocker Frontend\n"], [33, "# =============================================================================\n"], [34, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [35, "\n"], [36, "WORKDIR /app/ecolocker\n"], [37, "\n"], [38, "# Copy ecolocker package files\n"], [39, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [40, "\n"], [41, "# Install ecolocker dependencies\n"], [42, "RUN bun install\n"], [43, "\n"], [44, "# Copy ecolocker source\n"], [45, "COPY ecolocker/ .\n"], [46, "\n"], [47, "# Build ecolocker (vite build defaults to production mode)\n"], [48, "RUN bun run build\n"], [49, "\n"], [50, "# =============================================================================\n"], [51, "# Stage 3: Build Backend\n"], [52, "# =============================================================================\n"], [53, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [54, "\n"], [55, "WORKDIR /app/backend\n"], [56, "\n"], [57, "# Copy backend package files\n"], [58, "COPY backend/package.json backend/bun.lockb* ./\n"], [59, "\n"], [60, "# Install backend dependencies\n"], [61, "RUN bun install\n"], [62, "\n"], [63, "# Copy backend source\n"], [64, "COPY backend/ .\n"], [65, "\n"], [66, "# =============================================================================\n"], [67, "# Stage 4: Production Runtime\n"], [68, "# =============================================================================\n"], [69, "FROM oven/bun:1.2.5-alpine AS production\n"], [70, "\n"], [71, "WORKDIR /app\n"], [72, "\n"], [73, "# Update system packages to get security patches\n"], [74, "RUN apk update && apk upgrade --no-cache\n"], [75, "\n"], [76, "# Create non-root user for security\n"], [77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"], [79, "\n"], [80, "# Copy backend source and config\n"], [81, "COPY --from=backend-builder /app/backend/src ./src\n"], [82, "COPY --from=backend-builder /app/backend/package.json ./\n"], [83, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [84, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [85, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [86, "\n"], [87, "# Install production-only dependencies, then clean all scan-triggering artifacts in same layer\n"], [88, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [89, "# Bun cache contains bun-types docs with example Stripe key (Trivy secret false positive)\n"], [90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"], [94, "\n"], [95, "# Copy frontend build output to be served by backend\n"], [96, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [97, "\n"], [98, "# Copy ecolocker build output under public/ecolocker/\n"], [99, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [100, "\n"], [101, "# Copy entrypoint script\n"], [102, "COPY entrypoint.sh ./entrypoint.sh\n"], [103, "\n"], [104, "# Remove any remaining Go binaries from base image paths\n"], [105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [106, "\n"], [107, "# Create data directory for SQLite and make entrypoint executable\n"], [108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [109, "\n"], [110, "# Switch to non-root user\n"], [111, "USER ecoplate\n"], [112, "\n"], [113, "# Expose port\n"], [114, "EXPOSE 3000\n"], [115, "\n"], [116, "# Health check\n"], [117, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [118, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [119, "\n"], [120, "# Start with entrypoint (runs migration + seed if needed, then starts server)\n"], [121, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 121], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.WorkdirIsAbsolute", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-workdir-values-are-absolute-paths", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [8, "\n"], [9, "# Build args for frontend environment variables\n"], [10, "# Note: VITE_ prefixed keys are client-side and intentionally public (embedded in JS bundle)\n"], [11, "# Security is enforced via Google Cloud Console API key restrictions, not secrecy\n"], [12, "# hadolint ignore=DL3044\n"], [13, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [14, "# hadolint ignore=DL3044\n"], [15, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [16, "\n"], [17, "WORKDIR /app/frontend\n"], [18, "\n"], [19, "# Copy frontend package files\n"], [20, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [21, "\n"], [22, "# Install frontend dependencies\n"], [23, "RUN bun install\n"], [24, "\n"], [25, "# Copy frontend source\n"], [26, "COPY frontend/ .\n"], [27, "\n"], [28, "# Build frontend (outputs to /app/frontend/dist)\n"], [29, "RUN bun run build\n"], [30, "\n"], [31, "# =============================================================================\n"], [32, "# Stage 2: Build EcoLocker Frontend\n"], [33, "# =============================================================================\n"], [34, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [35, "\n"], [36, "WORKDIR /app/ecolocker\n"], [37, "\n"], [38, "# Copy ecolocker package files\n"], [39, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [40, "\n"], [41, "# Install ecolocker dependencies\n"], [42, "RUN bun install\n"], [43, "\n"], [44, "# Copy ecolocker source\n"], [45, "COPY ecolocker/ .\n"], [46, "\n"], [47, "# Build ecolocker (vite build defaults to production mode)\n"], [48, "RUN bun run build\n"], [49, "\n"], [50, "# =============================================================================\n"], [51, "# Stage 3: Build Backend\n"], [52, "# =============================================================================\n"], [53, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [54, "\n"], [55, "WORKDIR /app/backend\n"], [56, "\n"], [57, "# Copy backend package files\n"], [58, "COPY backend/package.json backend/bun.lockb* ./\n"], [59, "\n"], [60, "# Install backend dependencies\n"], [61, "RUN bun install\n"], [62, "\n"], [63, "# Copy backend source\n"], [64, "COPY backend/ .\n"], [65, "\n"], [66, "# =============================================================================\n"], [67, "# Stage 4: Production Runtime\n"], [68, "# =============================================================================\n"], [69, "FROM oven/bun:1.2.5-alpine AS production\n"], [70, "\n"], [71, "WORKDIR /app\n"], [72, "\n"], [73, "# Update system packages to get security patches\n"], [74, "RUN apk update && apk upgrade --no-cache\n"], [75, "\n"], [76, "# Create non-root user for security\n"], [77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"], [79, "\n"], [80, "# Copy backend source and config\n"], [81, "COPY --from=backend-builder /app/backend/src ./src\n"], [82, "COPY --from=backend-builder /app/backend/package.json ./\n"], [83, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [84, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [85, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [86, "\n"], [87, "# Install production-only dependencies, then clean all scan-triggering artifacts in same layer\n"], [88, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [89, "# Bun cache contains bun-types docs with example Stripe key (Trivy secret false positive)\n"], [90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"], [94, "\n"], [95, "# Copy frontend build output to be served by backend\n"], [96, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [97, "\n"], [98, "# Copy ecolocker build output under public/ecolocker/\n"], [99, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [100, "\n"], [101, "# Copy entrypoint script\n"], [102, "COPY entrypoint.sh ./entrypoint.sh\n"], [103, "\n"], [104, "# Remove any remaining Go binaries from base image paths\n"], [105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [106, "\n"], [107, "# Create data directory for SQLite and make entrypoint executable\n"], [108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [109, "\n"], [110, "# Switch to non-root user\n"], [111, "USER ecoplate\n"], [112, "\n"], [113, "# Expose port\n"], [114, "EXPOSE 3000\n"], [115, "\n"], [116, "# Health check\n"], [117, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [118, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [119, "\n"], [120, "# Start with entrypoint (runs migration + seed if needed, then starts server)\n"], [121, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 121], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [8, "\n"], [9, "# Build args for frontend environment variables\n"], [10, "# Note: VITE_ prefixed keys are client-side and intentionally public (embedded in JS bundle)\n"], [11, "# Security is enforced via Google Cloud Console API key restrictions, not secrecy\n"], [12, "# hadolint ignore=DL3044\n"], [13, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [14, "# hadolint ignore=DL3044\n"], [15, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [16, "\n"], [17, "WORKDIR /app/frontend\n"], [18, "\n"], [19, "# Copy frontend package files\n"], [20, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [21, "\n"], [22, "# Install frontend dependencies\n"], [23, "RUN bun install\n"], [24, "\n"], [25, "# Copy frontend source\n"], [26, "COPY frontend/ .\n"], [27, "\n"], [28, "# Build frontend (outputs to /app/frontend/dist)\n"], [29, "RUN bun run build\n"], [30, "\n"], [31, "# =============================================================================\n"], [32, "# Stage 2: Build EcoLocker Frontend\n"], [33, "# =============================================================================\n"], [34, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [35, "\n"], [36, "WORKDIR /app/ecolocker\n"], [37, "\n"], [38, "# Copy ecolocker package files\n"], [39, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [40, "\n"], [41, "# Install ecolocker dependencies\n"], [42, "RUN bun install\n"], [43, "\n"], [44, "# Copy ecolocker source\n"], [45, "COPY ecolocker/ .\n"], [46, "\n"], [47, "# Build ecolocker (vite build defaults to production mode)\n"], [48, "RUN bun run build\n"], [49, "\n"], [50, "# =============================================================================\n"], [51, "# Stage 3: Build Backend\n"], [52, "# =============================================================================\n"], [53, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [54, "\n"], [55, "WORKDIR /app/backend\n"], [56, "\n"], [57, "# Copy backend package files\n"], [58, "COPY backend/package.json backend/bun.lockb* ./\n"], [59, "\n"], [60, "# Install backend dependencies\n"], [61, "RUN bun install\n"], [62, "\n"], [63, "# Copy backend source\n"], [64, "COPY backend/ .\n"], [65, "\n"], [66, "# =============================================================================\n"], [67, "# Stage 4: Production Runtime\n"], [68, "# =============================================================================\n"], [69, "FROM oven/bun:1.2.5-alpine AS production\n"], [70, "\n"], [71, "WORKDIR /app\n"], [72, "\n"], [73, "# Update system packages to get security patches\n"], [74, "RUN apk update && apk upgrade --no-cache\n"], [75, "\n"], [76, "# Create non-root user for security\n"], [77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"], [79, "\n"], [80, "# Copy backend source and config\n"], [81, "COPY --from=backend-builder /app/backend/src ./src\n"], [82, "COPY --from=backend-builder /app/backend/package.json ./\n"], [83, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [84, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [85, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [86, "\n"], [87, "# Install production-only dependencies, then clean all scan-triggering artifacts in same layer\n"], [88, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [89, "# Bun cache contains bun-types docs with example Stripe key (Trivy secret false positive)\n"], [90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"], [94, "\n"], [95, "# Copy frontend build output to be served by backend\n"], [96, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [97, "\n"], [98, "# Copy ecolocker build output under public/ecolocker/\n"], [99, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [100, "\n"], [101, "# Copy entrypoint script\n"], [102, "COPY entrypoint.sh ./entrypoint.sh\n"], [103, "\n"], [104, "# Remove any remaining Go binaries from base image paths\n"], [105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [106, "\n"], [107, "# Create data directory for SQLite and make entrypoint executable\n"], [108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [109, "\n"], [110, "# Switch to non-root user\n"], [111, "USER ecoplate\n"], [112, "\n"], [113, "# Expose port\n"], [114, "EXPOSE 3000\n"], [115, "\n"], [116, "# Health check\n"], [117, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [118, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [119, "\n"], [120, "# Start with entrypoint (runs migration + seed if needed, then starts server)\n"], [121, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 121], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 116, "endline": 117, "content": "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n", "value": "--interval=30s --timeout=10s --start-period=15s --retries=5     CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1"}]}, "code_block": [[117, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [118, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [117, 118], "resource": "/Dockerfile.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 110, "endline": 110, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[111, "USER ecoplate\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [111, 111], "resource": "/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 12, "__endline__": 12}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 12, "__endline__": 12, "resource_type": "ARG", "hash": "d8564da02c4fdb5862b434f02c87919a3cf78f817b92196ccc9b1d38ebe95a04"}, "evaluated_keys": ["value"]}, "code_block": [[13, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [13, 13], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 14, "__endline__": 14}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 14, "__endline__": 14, "resource_type": "ENV", "hash": "ba42426dcab4b9fecaefbaa5e90d700be7c8b4d9de91f323444eb3b7ac6d99d7"}, "evaluated_keys": ["value"]}, "code_block": [[15, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [15, 15], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 12, "__endline__": 12}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 12, "__endline__": 12, "resource_type": "ARG", "hash": "d8564da02c4fdb5862b434f02c87919a3cf78f817b92196ccc9b1d38ebe95a04"}, "evaluated_keys": ["value"]}, "code_block": [[13, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [13, 13], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 14, "__endline__": 14}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 14, "__endline__": 14, "resource_type": "ENV", "hash": "ba42426dcab4b9fecaefbaa5e90d700be7c8b4d9de91f323444eb3b7ac6d99d7"}, "evaluated_keys": ["value"]}, "code_block": [[15, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [15, 15], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 12, "__endline__": 12}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 12, "__endline__": 12, "resource_type": "ARG", "hash": "d8564da02c4fdb5862b434f02c87919a3cf78f817b92196ccc9b1d38ebe95a04"}, "evaluated_keys": ["value"]}, "code_block": [[13, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [13, 13], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 14, "__endline__": 14}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 14, "__endline__": 14, "resource_type": "ENV", "hash": "ba42426dcab4b9fecaefbaa5e90d700be7c8b4d9de91f323444eb3b7ac6d99d7"}, "evaluated_keys": ["value"]}, "code_block": [[15, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [15, 15], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 12, "__endline__": 12}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 12, "__endline__": 12, "resource_type": "ARG", "hash": "d8564da02c4fdb5862b434f02c87919a3cf78f817b92196ccc9b1d38ebe95a04"}, "evaluated_keys": ["value"]}, "code_block": [[13, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [13, 13], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 14, "__endline__": 14}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 14, "__endline__": 14, "resource_type": "ENV", "hash": "ba42426dcab4b9fecaefbaa5e90d700be7c8b4d9de91f323444eb3b7ac6d99d7"}, "evaluated_keys": ["value"]}, "code_block": [[15, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [15, 15], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 12, "__endline__": 12}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 12, "__endline__": 12, "resource_type": "ARG", "hash": "d8564da02c4fdb5862b434f02c87919a3cf78f817b92196ccc9b1d38ebe95a04"}, "evaluated_keys": ["value"]}, "code_block": [[13, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [13, 13], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 14, "__endline__": 14}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 14, "__endline__": 14, "resource_type": "ENV", "hash": "ba42426dcab4b9fecaefbaa5e90d700be7c8b4d9de91f323444eb3b7ac6d99d7"}, "evaluated_keys": ["value"]}, "code_block": [[15, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [15, 15], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 7, "__endline__": 9, "resource_type": "RUN", "hash": "8367ade1d5c60450aefab75fbff9c193e0f67f365f0359a8f35edc9a1c85912f"}, "evaluated_keys": ["value"]}, "code_block": [[8, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [9, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [10, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [8, 10], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "686a4720f089c8ffbc924154750f1a561179ecf476548785fbbfa951a0bed45a"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [23, 23], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 28, "__endline__": 28, "resource_type": "RUN", "hash": "4b9e0904bdd35aa7491d8f6fef7919c3cafc61dc2368d2d267ed606141f7ee2a"}, "evaluated_keys": ["value"]}, "code_block": [[29, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [29, 29], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 41, "__endline__": 41, "resource_type": "RUN", "hash": "b2cc1c6431afe9831cbffcda44c29294eefa69a7ca1c44062c85aae703d96c40"}, "evaluated_keys": ["value"]}, "code_block": [[42, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [42, 42], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 47, "__endline__": 47, "resource_type": "RUN", "hash": "53b692deddcbce059f1d932c4e2a17b37cd21c3cff50d869e6e34c05bf5e3f06"}, "evaluated_keys": ["value"]}, "code_block": [[48, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [48, 48], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 60, "__endline__": 60, "resource_type": "RUN", "hash": "4c4a412e03f7b3b196ec9300405226a9988e9466118378e98b92d143efe649b9"}, "evaluated_keys": ["value"]}, "code_block": [[61, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [61, 61], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache\n", "value": "apk update && apk upgrade --no-cache", "__startline__": 73, "__endline__": 73, "resource_type": "RUN", "hash": "b67c8b34df064097586fa7e1a0474c12f541f9cfbbe638ec7e0081b9d59ceb1a"}, "evaluated_keys": ["value"]}, "code_block": [[74, "RUN apk update && apk upgrade --no-cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [74, 74], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 76, "__endline__": 77, "resource_type": "RUN", "hash": "cbabfbe68a4ee2feff6d0650cba2d5c6b0bf0d8e8be1dc9c6656f6793fb432df"}, "evaluated_keys": ["value"]}, "code_block": [[77, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [78, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [77, 78], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 89, "__endline__": 92, "resource_type": "RUN", "hash": "3899679008bf9e77d750dec786542440d5e57d5f096090e6d772299751cc565e"}, "evaluated_keys": ["value"]}, "code_block": [[90, "RUN bun install --production && \\\n"], [91, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [92, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [93, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [90, 93], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 104, "__endline__": 104, "resource_type": "RUN", "hash": "8cea5308c6b2627419823c329a7961617c32d7e6a1f75e0030f66be70c937ab7"}, "evaluated_keys": ["value"]}, "code_block": [[105, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [105, 105], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 107, "__endline__": 107, "resource_type": "RUN", "hash": "115f1d551232ce8088e19e9afed496acb905cb2bca710b6936045d6c3f6a591a"}, "evaluated_keys": ["value"]}, "code_block": [[108, "RUN mkdir -p /app/data && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [108, 108], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}], "failed_checks": [], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 274, "failed": 0, "skipped": 0, "parsing_errors": 0, "resource_count": 3, "checkov_version": "3.2.500"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}