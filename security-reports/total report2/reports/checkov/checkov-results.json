{"check_type": "dockerfile", "results": {"passed_checks": [{"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 3, "endline": 3, "content": "FROM python:3.12-slim-bookworm AS production\n", "value": "python:3.12-slim-bookworm AS production"}]}, "code_block": [[4, "FROM python:3.12-slim-bookworm AS production\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [4, 4], "resource": "/recommendation-engine/Dockerfile.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 23, "endline": 23, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[24, "USER ecoplate\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [24, 24], "resource": "/recommendation-engine/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_10", "check_name": "Ensure that WORKDIR values are absolute paths", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.WorkdirIsAbsolute", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-workdir-values-are-absolute-paths", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Recommendation Engine Dockerfile\n"], [2, "# Python Flask API for buyer/seller matching\n"], [3, "\n"], [4, "FROM python:3.12-slim-bookworm AS production\n"], [5, "\n"], [6, "WORKDIR /app\n"], [7, "\n"], [8, "# Update system packages to get security patches\n"], [9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"], [13, "\n"], [14, "# Install dependencies\n"], [15, "COPY requirements.txt .\n"], [16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"], [18, "\n"], [19, "# Copy application\n"], [20, "COPY . .\n"], [21, "\n"], [22, "# Create non-root user\n"], [23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"], [24, "USER ecoplate\n"], [25, "\n"], [26, "# Expose port\n"], [27, "EXPOSE 5000\n"], [28, "\n"], [29, "# Health check\n"], [30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"], [32, "\n"], [33, "# Run with gunicorn for production\n"], [34, "CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:5000\", \"--workers\", \"2\", \"app:app\"]"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [1, 34], "resource": "/recommendation-engine/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 29, "endline": 30, "content": "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n", "value": "--interval=30s --timeout=10s --start-period=5s --retries=3     CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1"}]}, "code_block": [[30, "HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n"], [31, "    CMD python -c \"import urllib.request; urllib.request.urlopen('http://localhost:5000/health')\" || exit 1\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [30, 31], "resource": "/recommendation-engine/Dockerfile.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 23, "endline": 23, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[24, "USER ecoplate\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [24, 24], "resource": "/recommendation-engine/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "# Pin to specific version for reproducible builds and security\n"], [8, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [9, "\n"], [10, "# Build args for frontend environment variables\n"], [11, "# Note: VITE_ prefixed keys are client-side and intentionally public (embedded in JS bundle)\n"], [12, "# Security is enforced via Google Cloud Console API key restrictions, not secrecy\n"], [13, "# hadolint ignore=DL3044\n"], [14, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [15, "# hadolint ignore=DL3044\n"], [16, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [17, "\n"], [18, "WORKDIR /app/frontend\n"], [19, "\n"], [20, "# Copy frontend package files\n"], [21, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [22, "\n"], [23, "# Install frontend dependencies\n"], [24, "RUN bun install\n"], [25, "\n"], [26, "# Copy frontend source\n"], [27, "COPY frontend/ .\n"], [28, "\n"], [29, "# Build frontend (outputs to /app/frontend/dist)\n"], [30, "RUN bun run build\n"], [31, "\n"], [32, "# =============================================================================\n"], [33, "# Stage 2: Build EcoLocker Frontend\n"], [34, "# =============================================================================\n"], [35, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [36, "\n"], [37, "# Build args for ecolocker environment variables (same as frontend)\n"], [38, "# hadolint ignore=DL3044\n"], [39, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [40, "# hadolint ignore=DL3044\n"], [41, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [42, "\n"], [43, "WORKDIR /app/ecolocker\n"], [44, "\n"], [45, "# Copy ecolocker package files\n"], [46, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [47, "\n"], [48, "# Install ecolocker dependencies\n"], [49, "RUN bun install\n"], [50, "\n"], [51, "# Copy ecolocker source\n"], [52, "COPY ecolocker/ .\n"], [53, "\n"], [54, "# Build ecolocker (vite build defaults to production mode)\n"], [55, "RUN bun run build\n"], [56, "\n"], [57, "# =============================================================================\n"], [58, "# Stage 3: Build Backend\n"], [59, "# =============================================================================\n"], [60, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [61, "\n"], [62, "WORKDIR /app/backend\n"], [63, "\n"], [64, "# Copy backend package files\n"], [65, "COPY backend/package.json backend/bun.lockb* ./\n"], [66, "\n"], [67, "# Install backend dependencies\n"], [68, "RUN bun install\n"], [69, "\n"], [70, "# Copy backend source\n"], [71, "COPY backend/ .\n"], [72, "\n"], [73, "# =============================================================================\n"], [74, "# Stage 4: Production Runtime\n"], [75, "# =============================================================================\n"], [76, "FROM oven/bun:1.2.5-alpine AS production\n"], [77, "\n"], [78, "WORKDIR /app\n"], [79, "\n"], [80, "# Update system packages to get security patches, install wget for health checks, and tzdata for timezone support\n"], [81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"], [82, "\n"], [83, "# Create non-root user for security\n"], [84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"], [86, "\n"], [87, "# Copy backend source and config\n"], [88, "COPY --from=backend-builder /app/backend/src ./src\n"], [89, "COPY --from=backend-builder /app/backend/package.json ./\n"], [90, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [91, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [92, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [93, "\n"], [94, "# Install production-only dependencies, then clean all scan-triggering artifacts in same layer\n"], [95, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [96, "# Bun cache contains bun-types docs with example Stripe key (Trivy secret false positive)\n"], [97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"], [101, "\n"], [102, "# Copy frontend build output to be served by backend\n"], [103, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [104, "\n"], [105, "# Copy ecolocker build output under public/ecolocker/\n"], [106, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [107, "\n"], [108, "# Copy entrypoint script\n"], [109, "COPY entrypoint.sh ./entrypoint.sh\n"], [110, "\n"], [111, "# Remove any remaining Go binaries from base image paths\n"], [112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [113, "\n"], [114, "# Create data and uploads directories, set ownership, make entrypoint executable\n"], [115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [116, "\n"], [117, "# Run as non-root user (CWE-269: Improper Privilege Management)\n"], [118, "# Named Docker volumes inherit directory ownership from the container,\n"], [119, "# so /app/data and /app/public/uploads will be writable by ecoplate.\n"], [120, "USER ecoplate\n"], [121, "\n"], [122, "# Expose port\n"], [123, "EXPOSE 3000\n"], [124, "\n"], [125, "# Health check\n"], [126, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [127, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [128, "\n"], [129, "# Start with entrypoint (runs migration + seed, then starts server)\n"], [130, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 130], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 75, "endline": 75, "content": "FROM oven/bun:1.2.5-alpine AS production\n", "value": "oven/bun:1.2.5-alpine AS production"}]}, "code_block": [[76, "FROM oven/bun:1.2.5-alpine AS production\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [76, 76], "resource": "/Dockerfile.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "# Pin to specific version for reproducible builds and security\n"], [8, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [9, "\n"], [10, "# Build args for frontend environment variables\n"], [11, "# Note: VITE_ prefixed keys are client-side and intentionally public (embedded in JS bundle)\n"], [12, "# Security is enforced via Google Cloud Console API key restrictions, not secrecy\n"], [13, "# hadolint ignore=DL3044\n"], [14, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [15, "# hadolint ignore=DL3044\n"], [16, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [17, "\n"], [18, "WORKDIR /app/frontend\n"], [19, "\n"], [20, "# Copy frontend package files\n"], [21, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [22, "\n"], [23, "# Install frontend dependencies\n"], [24, "RUN bun install\n"], [25, "\n"], [26, "# Copy frontend source\n"], [27, "COPY frontend/ .\n"], [28, "\n"], [29, "# Build frontend (outputs to /app/frontend/dist)\n"], [30, "RUN bun run build\n"], [31, "\n"], [32, "# =============================================================================\n"], [33, "# Stage 2: Build EcoLocker Frontend\n"], [34, "# =============================================================================\n"], [35, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [36, "\n"], [37, "# Build args for ecolocker environment variables (same as frontend)\n"], [38, "# hadolint ignore=DL3044\n"], [39, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [40, "# hadolint ignore=DL3044\n"], [41, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [42, "\n"], [43, "WORKDIR /app/ecolocker\n"], [44, "\n"], [45, "# Copy ecolocker package files\n"], [46, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [47, "\n"], [48, "# Install ecolocker dependencies\n"], [49, "RUN bun install\n"], [50, "\n"], [51, "# Copy ecolocker source\n"], [52, "COPY ecolocker/ .\n"], [53, "\n"], [54, "# Build ecolocker (vite build defaults to production mode)\n"], [55, "RUN bun run build\n"], [56, "\n"], [57, "# =============================================================================\n"], [58, "# Stage 3: Build Backend\n"], [59, "# =============================================================================\n"], [60, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [61, "\n"], [62, "WORKDIR /app/backend\n"], [63, "\n"], [64, "# Copy backend package files\n"], [65, "COPY backend/package.json backend/bun.lockb* ./\n"], [66, "\n"], [67, "# Install backend dependencies\n"], [68, "RUN bun install\n"], [69, "\n"], [70, "# Copy backend source\n"], [71, "COPY backend/ .\n"], [72, "\n"], [73, "# =============================================================================\n"], [74, "# Stage 4: Production Runtime\n"], [75, "# =============================================================================\n"], [76, "FROM oven/bun:1.2.5-alpine AS production\n"], [77, "\n"], [78, "WORKDIR /app\n"], [79, "\n"], [80, "# Update system packages to get security patches, install wget for health checks, and tzdata for timezone support\n"], [81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"], [82, "\n"], [83, "# Create non-root user for security\n"], [84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"], [86, "\n"], [87, "# Copy backend source and config\n"], [88, "COPY --from=backend-builder /app/backend/src ./src\n"], [89, "COPY --from=backend-builder /app/backend/package.json ./\n"], [90, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [91, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [92, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [93, "\n"], [94, "# Install production-only dependencies, then clean all scan-triggering artifacts in same layer\n"], [95, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [96, "# Bun cache contains bun-types docs with example Stripe key (Trivy secret false positive)\n"], [97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"], [101, "\n"], [102, "# Copy frontend build output to be served by backend\n"], [103, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [104, "\n"], [105, "# Copy ecolocker build output under public/ecolocker/\n"], [106, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [107, "\n"], [108, "# Copy entrypoint script\n"], [109, "COPY entrypoint.sh ./entrypoint.sh\n"], [110, "\n"], [111, "# Remove any remaining Go binaries from base image paths\n"], [112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [113, "\n"], [114, "# Create data and uploads directories, set ownership, make entrypoint executable\n"], [115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [116, "\n"], [117, "# Run as non-root user (CWE-269: Improper Privilege Management)\n"], [118, "# Named Docker volumes inherit directory ownership from the container,\n"], [119, "# so /app/data and /app/public/uploads will be writable by ecoplate.\n"], [120, "USER ecoplate\n"], [121, "\n"], [122, "# Expose port\n"], [123, "EXPOSE 3000\n"], [124, "\n"], [125, "# Health check\n"], [126, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [127, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [128, "\n"], [129, "# Start with entrypoint (runs migration + seed, then starts server)\n"], [130, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 130], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 119, "endline": 119, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[120, "USER ecoplate\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [120, 120], "resource": "/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_10", "check_name": "Ensure that WORKDIR values are absolute paths", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "# Pin to specific version for reproducible builds and security\n"], [8, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [9, "\n"], [10, "# Build args for frontend environment variables\n"], [11, "# Note: VITE_ prefixed keys are client-side and intentionally public (embedded in JS bundle)\n"], [12, "# Security is enforced via Google Cloud Console API key restrictions, not secrecy\n"], [13, "# hadolint ignore=DL3044\n"], [14, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [15, "# hadolint ignore=DL3044\n"], [16, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [17, "\n"], [18, "WORKDIR /app/frontend\n"], [19, "\n"], [20, "# Copy frontend package files\n"], [21, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [22, "\n"], [23, "# Install frontend dependencies\n"], [24, "RUN bun install\n"], [25, "\n"], [26, "# Copy frontend source\n"], [27, "COPY frontend/ .\n"], [28, "\n"], [29, "# Build frontend (outputs to /app/frontend/dist)\n"], [30, "RUN bun run build\n"], [31, "\n"], [32, "# =============================================================================\n"], [33, "# Stage 2: Build EcoLocker Frontend\n"], [34, "# =============================================================================\n"], [35, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [36, "\n"], [37, "# Build args for ecolocker environment variables (same as frontend)\n"], [38, "# hadolint ignore=DL3044\n"], [39, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [40, "# hadolint ignore=DL3044\n"], [41, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [42, "\n"], [43, "WORKDIR /app/ecolocker\n"], [44, "\n"], [45, "# Copy ecolocker package files\n"], [46, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [47, "\n"], [48, "# Install ecolocker dependencies\n"], [49, "RUN bun install\n"], [50, "\n"], [51, "# Copy ecolocker source\n"], [52, "COPY ecolocker/ .\n"], [53, "\n"], [54, "# Build ecolocker (vite build defaults to production mode)\n"], [55, "RUN bun run build\n"], [56, "\n"], [57, "# =============================================================================\n"], [58, "# Stage 3: Build Backend\n"], [59, "# =============================================================================\n"], [60, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [61, "\n"], [62, "WORKDIR /app/backend\n"], [63, "\n"], [64, "# Copy backend package files\n"], [65, "COPY backend/package.json backend/bun.lockb* ./\n"], [66, "\n"], [67, "# Install backend dependencies\n"], [68, "RUN bun install\n"], [69, "\n"], [70, "# Copy backend source\n"], [71, "COPY backend/ .\n"], [72, "\n"], [73, "# =============================================================================\n"], [74, "# Stage 4: Production Runtime\n"], [75, "# =============================================================================\n"], [76, "FROM oven/bun:1.2.5-alpine AS production\n"], [77, "\n"], [78, "WORKDIR /app\n"], [79, "\n"], [80, "# Update system packages to get security patches, install wget for health checks, and tzdata for timezone support\n"], [81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"], [82, "\n"], [83, "# Create non-root user for security\n"], [84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"], [86, "\n"], [87, "# Copy backend source and config\n"], [88, "COPY --from=backend-builder /app/backend/src ./src\n"], [89, "COPY --from=backend-builder /app/backend/package.json ./\n"], [90, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [91, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [92, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [93, "\n"], [94, "# Install production-only dependencies, then clean all scan-triggering artifacts in same layer\n"], [95, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [96, "# Bun cache contains bun-types docs with example Stripe key (Trivy secret false positive)\n"], [97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"], [101, "\n"], [102, "# Copy frontend build output to be served by backend\n"], [103, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [104, "\n"], [105, "# Copy ecolocker build output under public/ecolocker/\n"], [106, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [107, "\n"], [108, "# Copy entrypoint script\n"], [109, "COPY entrypoint.sh ./entrypoint.sh\n"], [110, "\n"], [111, "# Remove any remaining Go binaries from base image paths\n"], [112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [113, "\n"], [114, "# Create data and uploads directories, set ownership, make entrypoint executable\n"], [115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [116, "\n"], [117, "# Run as non-root user (CWE-269: Improper Privilege Management)\n"], [118, "# Named Docker volumes inherit directory ownership from the container,\n"], [119, "# so /app/data and /app/public/uploads will be writable by ecoplate.\n"], [120, "USER ecoplate\n"], [121, "\n"], [122, "# Expose port\n"], [123, "EXPOSE 3000\n"], [124, "\n"], [125, "# Health check\n"], [126, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [127, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [128, "\n"], [129, "# Start with entrypoint (runs migration + seed, then starts server)\n"], [130, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 130], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.WorkdirIsAbsolute", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-workdir-values-are-absolute-paths", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "# Pin to specific version for reproducible builds and security\n"], [8, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [9, "\n"], [10, "# Build args for frontend environment variables\n"], [11, "# Note: VITE_ prefixed keys are client-side and intentionally public (embedded in JS bundle)\n"], [12, "# Security is enforced via Google Cloud Console API key restrictions, not secrecy\n"], [13, "# hadolint ignore=DL3044\n"], [14, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [15, "# hadolint ignore=DL3044\n"], [16, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [17, "\n"], [18, "WORKDIR /app/frontend\n"], [19, "\n"], [20, "# Copy frontend package files\n"], [21, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [22, "\n"], [23, "# Install frontend dependencies\n"], [24, "RUN bun install\n"], [25, "\n"], [26, "# Copy frontend source\n"], [27, "COPY frontend/ .\n"], [28, "\n"], [29, "# Build frontend (outputs to /app/frontend/dist)\n"], [30, "RUN bun run build\n"], [31, "\n"], [32, "# =============================================================================\n"], [33, "# Stage 2: Build EcoLocker Frontend\n"], [34, "# =============================================================================\n"], [35, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [36, "\n"], [37, "# Build args for ecolocker environment variables (same as frontend)\n"], [38, "# hadolint ignore=DL3044\n"], [39, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [40, "# hadolint ignore=DL3044\n"], [41, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [42, "\n"], [43, "WORKDIR /app/ecolocker\n"], [44, "\n"], [45, "# Copy ecolocker package files\n"], [46, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [47, "\n"], [48, "# Install ecolocker dependencies\n"], [49, "RUN bun install\n"], [50, "\n"], [51, "# Copy ecolocker source\n"], [52, "COPY ecolocker/ .\n"], [53, "\n"], [54, "# Build ecolocker (vite build defaults to production mode)\n"], [55, "RUN bun run build\n"], [56, "\n"], [57, "# =============================================================================\n"], [58, "# Stage 3: Build Backend\n"], [59, "# =============================================================================\n"], [60, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [61, "\n"], [62, "WORKDIR /app/backend\n"], [63, "\n"], [64, "# Copy backend package files\n"], [65, "COPY backend/package.json backend/bun.lockb* ./\n"], [66, "\n"], [67, "# Install backend dependencies\n"], [68, "RUN bun install\n"], [69, "\n"], [70, "# Copy backend source\n"], [71, "COPY backend/ .\n"], [72, "\n"], [73, "# =============================================================================\n"], [74, "# Stage 4: Production Runtime\n"], [75, "# =============================================================================\n"], [76, "FROM oven/bun:1.2.5-alpine AS production\n"], [77, "\n"], [78, "WORKDIR /app\n"], [79, "\n"], [80, "# Update system packages to get security patches, install wget for health checks, and tzdata for timezone support\n"], [81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"], [82, "\n"], [83, "# Create non-root user for security\n"], [84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"], [86, "\n"], [87, "# Copy backend source and config\n"], [88, "COPY --from=backend-builder /app/backend/src ./src\n"], [89, "COPY --from=backend-builder /app/backend/package.json ./\n"], [90, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [91, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [92, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [93, "\n"], [94, "# Install production-only dependencies, then clean all scan-triggering artifacts in same layer\n"], [95, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [96, "# Bun cache contains bun-types docs with example Stripe key (Trivy secret false positive)\n"], [97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"], [101, "\n"], [102, "# Copy frontend build output to be served by backend\n"], [103, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [104, "\n"], [105, "# Copy ecolocker build output under public/ecolocker/\n"], [106, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [107, "\n"], [108, "# Copy entrypoint script\n"], [109, "COPY entrypoint.sh ./entrypoint.sh\n"], [110, "\n"], [111, "# Remove any remaining Go binaries from base image paths\n"], [112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [113, "\n"], [114, "# Create data and uploads directories, set ownership, make entrypoint executable\n"], [115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [116, "\n"], [117, "# Run as non-root user (CWE-269: Improper Privilege Management)\n"], [118, "# Named Docker volumes inherit directory ownership from the container,\n"], [119, "# so /app/data and /app/public/uploads will be writable by ecoplate.\n"], [120, "USER ecoplate\n"], [121, "\n"], [122, "# Expose port\n"], [123, "EXPOSE 3000\n"], [124, "\n"], [125, "# Health check\n"], [126, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [127, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [128, "\n"], [129, "# Start with entrypoint (runs migration + seed, then starts server)\n"], [130, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 130], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# EcoPlate Unified Dockerfile\n"], [2, "# Runs both frontend and backend in a single container\n"], [3, "\n"], [4, "# =============================================================================\n"], [5, "# Stage 1: Build Frontend\n"], [6, "# =============================================================================\n"], [7, "# Pin to specific version for reproducible builds and security\n"], [8, "FROM oven/bun:1.2.5-alpine AS frontend-builder\n"], [9, "\n"], [10, "# Build args for frontend environment variables\n"], [11, "# Note: VITE_ prefixed keys are client-side and intentionally public (embedded in JS bundle)\n"], [12, "# Security is enforced via Google Cloud Console API key restrictions, not secrecy\n"], [13, "# hadolint ignore=DL3044\n"], [14, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [15, "# hadolint ignore=DL3044\n"], [16, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [17, "\n"], [18, "WORKDIR /app/frontend\n"], [19, "\n"], [20, "# Copy frontend package files\n"], [21, "COPY frontend/package.json frontend/bun.lockb* ./\n"], [22, "\n"], [23, "# Install frontend dependencies\n"], [24, "RUN bun install\n"], [25, "\n"], [26, "# Copy frontend source\n"], [27, "COPY frontend/ .\n"], [28, "\n"], [29, "# Build frontend (outputs to /app/frontend/dist)\n"], [30, "RUN bun run build\n"], [31, "\n"], [32, "# =============================================================================\n"], [33, "# Stage 2: Build EcoLocker Frontend\n"], [34, "# =============================================================================\n"], [35, "FROM oven/bun:1.2.5-alpine AS ecolocker-builder\n"], [36, "\n"], [37, "# Build args for ecolocker environment variables (same as frontend)\n"], [38, "# hadolint ignore=DL3044\n"], [39, "ARG VITE_GOOGLE_MAPS_API_KEY\n"], [40, "# hadolint ignore=DL3044\n"], [41, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"], [42, "\n"], [43, "WORKDIR /app/ecolocker\n"], [44, "\n"], [45, "# Copy ecolocker package files\n"], [46, "COPY ecolocker/package.json ecolocker/bun.lockb* ./\n"], [47, "\n"], [48, "# Install ecolocker dependencies\n"], [49, "RUN bun install\n"], [50, "\n"], [51, "# Copy ecolocker source\n"], [52, "COPY ecolocker/ .\n"], [53, "\n"], [54, "# Build ecolocker (vite build defaults to production mode)\n"], [55, "RUN bun run build\n"], [56, "\n"], [57, "# =============================================================================\n"], [58, "# Stage 3: Build Backend\n"], [59, "# =============================================================================\n"], [60, "FROM oven/bun:1.2.5-alpine AS backend-builder\n"], [61, "\n"], [62, "WORKDIR /app/backend\n"], [63, "\n"], [64, "# Copy backend package files\n"], [65, "COPY backend/package.json backend/bun.lockb* ./\n"], [66, "\n"], [67, "# Install backend dependencies\n"], [68, "RUN bun install\n"], [69, "\n"], [70, "# Copy backend source\n"], [71, "COPY backend/ .\n"], [72, "\n"], [73, "# =============================================================================\n"], [74, "# Stage 4: Production Runtime\n"], [75, "# =============================================================================\n"], [76, "FROM oven/bun:1.2.5-alpine AS production\n"], [77, "\n"], [78, "WORKDIR /app\n"], [79, "\n"], [80, "# Update system packages to get security patches, install wget for health checks, and tzdata for timezone support\n"], [81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"], [82, "\n"], [83, "# Create non-root user for security\n"], [84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"], [86, "\n"], [87, "# Copy backend source and config\n"], [88, "COPY --from=backend-builder /app/backend/src ./src\n"], [89, "COPY --from=backend-builder /app/backend/package.json ./\n"], [90, "COPY --from=backend-builder /app/backend/tsconfig.json ./\n"], [91, "COPY --from=backend-builder /app/backend/drizzle.config.ts ./\n"], [92, "COPY --from=backend-builder /app/backend/bun.lockb* ./\n"], [93, "\n"], [94, "# Install production-only dependencies, then clean all scan-triggering artifacts in same layer\n"], [95, "# Go binaries in node_modules cause Trivy CVEs (CVE-2024-24790, CVE-2023-39325, CVE-2025-58183)\n"], [96, "# Bun cache contains bun-types docs with example Stripe key (Trivy secret false positive)\n"], [97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"], [101, "\n"], [102, "# Copy frontend build output to be served by backend\n"], [103, "COPY --from=frontend-builder /app/frontend/dist ./public\n"], [104, "\n"], [105, "# Copy ecolocker build output under public/ecolocker/\n"], [106, "COPY --from=ecolocker-builder /app/ecolocker/dist ./public/ecolocker\n"], [107, "\n"], [108, "# Copy entrypoint script\n"], [109, "COPY entrypoint.sh ./entrypoint.sh\n"], [110, "\n"], [111, "# Remove any remaining Go binaries from base image paths\n"], [112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"], [113, "\n"], [114, "# Create data and uploads directories, set ownership, make entrypoint executable\n"], [115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"], [116, "\n"], [117, "# Run as non-root user (CWE-269: Improper Privilege Management)\n"], [118, "# Named Docker volumes inherit directory ownership from the container,\n"], [119, "# so /app/data and /app/public/uploads will be writable by ecoplate.\n"], [120, "USER ecoplate\n"], [121, "\n"], [122, "# Expose port\n"], [123, "EXPOSE 3000\n"], [124, "\n"], [125, "# Health check\n"], [126, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [127, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"], [128, "\n"], [129, "# Start with entrypoint (runs migration + seed, then starts server)\n"], [130, "ENTRYPOINT [\"sh\", \"/app/entrypoint.sh\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [1, 130], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 125, "endline": 126, "content": "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n", "value": "--interval=30s --timeout=10s --start-period=15s --retries=5     CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1"}]}, "code_block": [[126, "HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=5 \\\n"], [127, "    CMD wget --no-verbose --tries=1 --spider http://localhost:3000/api/v1/health || exit 1\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [126, 127], "resource": "/Dockerfile.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 119, "endline": 119, "content": "USER ecoplate\n", "value": "ecoplate"}]}, "code_block": [[120, "USER ecoplate\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [120, 120], "resource": "/Dockerfile.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_1", "bc_check_id": "BC_DKR_1", "check_name": "Ensure port 22 is not exposed", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Stage 1: Build headers-more-nginx-module for Server header removal (CWE-204)\n"], [2, "FROM nginx:alpine AS builder\n"], [3, "\n"], [4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"], [15, "\n"], [16, "# Stage 2: Production image\n"], [17, "FROM nginx:alpine\n"], [18, "\n"], [19, "# Copy compiled headers-more module\n"], [20, "COPY --from=builder /tmp/nginx/objs/ngx_http_headers_more_filter_module.so /etc/nginx/modules/\n"], [21, "\n"], [22, "# Load the module in main nginx config\n"], [23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"], [24, "\n"], [25, "# Configure nginx to run as non-root user (CKV_DOCKER_3)\n"], [26, "# nginx:alpine already has nginx user (uid 101), just need to fix permissions\n"], [27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"], [30, "\n"], [31, "# Switch to non-root user\n"], [32, "USER nginx\n"], [33, "\n"], [34, "# Expose HTTP and HTTPS ports\n"], [35, "EXPOSE 8080 8443\n"], [36, "\n"], [37, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [38, "    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 38], "resource": "/deploy/Dockerfile.nginx.", "evaluations": null, "check_class": "checkov.dockerfile.checks.ExposePort22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-port-22-is-not-exposed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 16, "endline": 16, "content": "FROM nginx:alpine\n", "value": "nginx:alpine"}]}, "code_block": [[17, "FROM nginx:alpine\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [17, 17], "resource": "/deploy/Dockerfile.nginx.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Stage 1: Build headers-more-nginx-module for Server header removal (CWE-204)\n"], [2, "FROM nginx:alpine AS builder\n"], [3, "\n"], [4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"], [15, "\n"], [16, "# Stage 2: Production image\n"], [17, "FROM nginx:alpine\n"], [18, "\n"], [19, "# Copy compiled headers-more module\n"], [20, "COPY --from=builder /tmp/nginx/objs/ngx_http_headers_more_filter_module.so /etc/nginx/modules/\n"], [21, "\n"], [22, "# Load the module in main nginx config\n"], [23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"], [24, "\n"], [25, "# Configure nginx to run as non-root user (CKV_DOCKER_3)\n"], [26, "# nginx:alpine already has nginx user (uid 101), just need to fix permissions\n"], [27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"], [30, "\n"], [31, "# Switch to non-root user\n"], [32, "USER nginx\n"], [33, "\n"], [34, "# Expose HTTP and HTTPS ports\n"], [35, "EXPOSE 8080 8443\n"], [36, "\n"], [37, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [38, "    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 38], "resource": "/deploy/Dockerfile.nginx.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_8", "bc_check_id": "BC_DKR_8", "check_name": "Ensure the last USER is not root", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 31, "endline": 31, "content": "USER nginx\n", "value": "nginx"}]}, "code_block": [[32, "USER nginx\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [32, 32], "resource": "/deploy/Dockerfile.nginx.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.RootUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-the-last-user-is-not-root", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_9", "bc_check_id": "BC_DKR_NETWORKING_1", "check_name": "Ensure that APT isn't used", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Stage 1: Build headers-more-nginx-module for Server header removal (CWE-204)\n"], [2, "FROM nginx:alpine AS builder\n"], [3, "\n"], [4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"], [15, "\n"], [16, "# Stage 2: Production image\n"], [17, "FROM nginx:alpine\n"], [18, "\n"], [19, "# Copy compiled headers-more module\n"], [20, "COPY --from=builder /tmp/nginx/objs/ngx_http_headers_more_filter_module.so /etc/nginx/modules/\n"], [21, "\n"], [22, "# Load the module in main nginx config\n"], [23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"], [24, "\n"], [25, "# Configure nginx to run as non-root user (CKV_DOCKER_3)\n"], [26, "# nginx:alpine already has nginx user (uid 101), just need to fix permissions\n"], [27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"], [30, "\n"], [31, "# Switch to non-root user\n"], [32, "USER nginx\n"], [33, "\n"], [34, "# Expose HTTP and HTTPS ports\n"], [35, "EXPOSE 8080 8443\n"], [36, "\n"], [37, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [38, "    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 38], "resource": "/deploy/Dockerfile.nginx.", "evaluations": null, "check_class": "checkov.dockerfile.checks.RunUsingAPT", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-is-not-used", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_5", "bc_check_id": "BC_DKR_4", "check_name": "Ensure update instructions are not use alone in the Dockerfile", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "# Stage 1: Build headers-more-nginx-module for Server header removal (CWE-204)\n"], [2, "FROM nginx:alpine AS builder\n"], [3, "\n"], [4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"], [15, "\n"], [16, "# Stage 2: Production image\n"], [17, "FROM nginx:alpine\n"], [18, "\n"], [19, "# Copy compiled headers-more module\n"], [20, "COPY --from=builder /tmp/nginx/objs/ngx_http_headers_more_filter_module.so /etc/nginx/modules/\n"], [21, "\n"], [22, "# Load the module in main nginx config\n"], [23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"], [24, "\n"], [25, "# Configure nginx to run as non-root user (CKV_DOCKER_3)\n"], [26, "# nginx:alpine already has nginx user (uid 101), just need to fix permissions\n"], [27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"], [30, "\n"], [31, "# Switch to non-root user\n"], [32, "USER nginx\n"], [33, "\n"], [34, "# Expose HTTP and HTTPS ports\n"], [35, "EXPOSE 8080 8443\n"], [36, "\n"], [37, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [38, "    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [1, 38], "resource": "/deploy/Dockerfile.nginx.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UpdateNotAlone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-update-instructions-are-not-used-alone-in-the-dockerfile", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "HEALTHCHECK", "startline": 36, "endline": 37, "content": "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1", "value": "--interval=30s --timeout=5s --retries=3     CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"}]}, "code_block": [[37, "HEALTHCHECK --interval=30s --timeout=5s --retries=3 \\\n"], [38, "    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/nginx-health || exit 1"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [37, 38], "resource": "/deploy/Dockerfile.nginx.HEALTHCHECK", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "USER", "startline": 31, "endline": 31, "content": "USER nginx\n", "value": "nginx"}]}, "code_block": [[32, "USER nginx\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [32, 32], "resource": "/deploy/Dockerfile.nginx.USER", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 13, "__endline__": 13}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 13, "__endline__": 13, "resource_type": "ARG", "hash": "0008e1f7db9f754bc6418ad216b8629447ffd7acb3aaf07eb3e65aae7f455b63"}, "evaluated_keys": ["value"]}, "code_block": [[14, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [14, 14], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 38, "__endline__": 38}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 38, "__endline__": 38, "resource_type": "ARG", "hash": "7e8a3b7270734957c0416a160e9a3c79fab44ea6651afb498bf3c5560f9b62de"}, "evaluated_keys": ["value"]}, "code_block": [[39, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [39, 39], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 15, "__endline__": 15}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 15, "__endline__": 15, "resource_type": "ENV", "hash": "278277d393534a9ac2316741e5d6ab553f58b83c1b45bfe2efa94533057015b5"}, "evaluated_keys": ["value"]}, "code_block": [[16, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [16, 16], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 40, "__endline__": 40}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 40, "__endline__": 40, "resource_type": "ENV", "hash": "c89f663e7e7c6f9a98d0f981b6e5b6039830f54bb1df353d4864c7ccd02e353e"}, "evaluated_keys": ["value"]}, "code_block": [[41, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [41, 41], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_5", "bc_check_id": "BC_DKR_GENERAL_15", "check_name": "Ensure that certificate validation isn't disabled with the PYTHONHTTPSVERIFY environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-PYTHONHTTPSVERIFY-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_1", "bc_check_id": "BC_DKR_GENERAL_11", "check_name": "Ensure that sudo isn't used", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-dont-use-sudo", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 13, "__endline__": 13}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 13, "__endline__": 13, "resource_type": "ARG", "hash": "0008e1f7db9f754bc6418ad216b8629447ffd7acb3aaf07eb3e65aae7f455b63"}, "evaluated_keys": ["value"]}, "code_block": [[14, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [14, 14], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 38, "__endline__": 38}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 38, "__endline__": 38, "resource_type": "ARG", "hash": "7e8a3b7270734957c0416a160e9a3c79fab44ea6651afb498bf3c5560f9b62de"}, "evaluated_keys": ["value"]}, "code_block": [[39, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [39, 39], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 15, "__endline__": 15}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 15, "__endline__": 15, "resource_type": "ENV", "hash": "278277d393534a9ac2316741e5d6ab553f58b83c1b45bfe2efa94533057015b5"}, "evaluated_keys": ["value"]}, "code_block": [[16, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [16, 16], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 40, "__endline__": 40}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 40, "__endline__": 40, "resource_type": "ENV", "hash": "c89f663e7e7c6f9a98d0f981b6e5b6039830f54bb1df353d4864c7ccd02e353e"}, "evaluated_keys": ["value"]}, "code_block": [[41, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [41, 41], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_16", "bc_check_id": "BC_DKR_GENERAL_26", "check_name": "Ensure that certificate validation isn't disabled with pip via the 'PIP_TRUSTED_HOST' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-trusted-host", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 13, "__endline__": 13}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 13, "__endline__": 13, "resource_type": "ARG", "hash": "0008e1f7db9f754bc6418ad216b8629447ffd7acb3aaf07eb3e65aae7f455b63"}, "evaluated_keys": ["value"]}, "code_block": [[14, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [14, 14], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 38, "__endline__": 38}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 38, "__endline__": 38, "resource_type": "ARG", "hash": "7e8a3b7270734957c0416a160e9a3c79fab44ea6651afb498bf3c5560f9b62de"}, "evaluated_keys": ["value"]}, "code_block": [[39, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [39, 39], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 15, "__endline__": 15}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 15, "__endline__": 15, "resource_type": "ENV", "hash": "278277d393534a9ac2316741e5d6ab553f58b83c1b45bfe2efa94533057015b5"}, "evaluated_keys": ["value"]}, "code_block": [[16, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [16, 16], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 40, "__endline__": 40}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 40, "__endline__": 40, "resource_type": "ENV", "hash": "c89f663e7e7c6f9a98d0f981b6e5b6039830f54bb1df353d4864c7ccd02e353e"}, "evaluated_keys": ["value"]}, "code_block": [[41, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [41, 41], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_6", "bc_check_id": "BC_DKR_GENERAL_16", "check_name": "Ensure that certificate validation isn't disabled with the NODE_TLS_REJECT_UNAUTHORIZED environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-node-tls-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 13, "__endline__": 13}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 13, "__endline__": 13, "resource_type": "ARG", "hash": "0008e1f7db9f754bc6418ad216b8629447ffd7acb3aaf07eb3e65aae7f455b63"}, "evaluated_keys": ["value"]}, "code_block": [[14, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [14, 14], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 38, "__endline__": 38}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 38, "__endline__": 38, "resource_type": "ARG", "hash": "7e8a3b7270734957c0416a160e9a3c79fab44ea6651afb498bf3c5560f9b62de"}, "evaluated_keys": ["value"]}, "code_block": [[39, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [39, 39], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 15, "__endline__": 15}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 15, "__endline__": 15, "resource_type": "ENV", "hash": "278277d393534a9ac2316741e5d6ab553f58b83c1b45bfe2efa94533057015b5"}, "evaluated_keys": ["value"]}, "code_block": [[16, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [16, 16], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 40, "__endline__": 40}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 40, "__endline__": 40, "resource_type": "ENV", "hash": "c89f663e7e7c6f9a98d0f981b6e5b6039830f54bb1df353d4864c7ccd02e353e"}, "evaluated_keys": ["value"]}, "code_block": [[41, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [41, 41], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_12", "bc_check_id": "BC_DKR_GENERAL_22", "check_name": "Ensure that certificate validation isn't disabled for npm via the 'NPM_CONFIG_STRICT_SSL' environment variable", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_2", "bc_check_id": "BC_DKR_GENERAL_12", "check_name": "Ensure that certificate validation isn't disabled with curl", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-curl-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_13", "bc_check_id": "BC_DKR_GENERAL_23", "check_name": "Ensure that certificate validation isn't disabled for npm or yarn by setting the option strict-ssl to false", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-npm-strict-ssl2", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 13, "__endline__": 13}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 13, "__endline__": 13, "resource_type": "ARG", "hash": "0008e1f7db9f754bc6418ad216b8629447ffd7acb3aaf07eb3e65aae7f455b63"}, "evaluated_keys": ["value"]}, "code_block": [[14, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [14, 14], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "ARG", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 38, "__endline__": 38}, "label_": "resource: ARG", "id_": "ARG", "source_": "Dockerfile", "content": "ARG VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY", "__startline__": 38, "__endline__": 38, "resource_type": "ARG", "hash": "7e8a3b7270734957c0416a160e9a3c79fab44ea6651afb498bf3c5560f9b62de"}, "evaluated_keys": ["value"]}, "code_block": [[39, "ARG VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [39, 39], "resource": "/Dockerfile.ARG", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 15, "__endline__": 15}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 15, "__endline__": 15, "resource_type": "ENV", "hash": "278277d393534a9ac2316741e5d6ab553f58b83c1b45bfe2efa94533057015b5"}, "evaluated_keys": ["value"]}, "code_block": [[16, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [16, 16], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "ENV", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 40, "__endline__": 40}, "label_": "resource: ENV", "id_": "ENV", "source_": "Dockerfile", "content": "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n", "value": "VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY", "__startline__": 40, "__endline__": 40, "resource_type": "ENV", "hash": "c89f663e7e7c6f9a98d0f981b6e5b6039830f54bb1df353d4864c7ccd02e353e"}, "evaluated_keys": ["value"]}, "code_block": [[41, "ENV VITE_GOOGLE_MAPS_API_KEY=$VITE_GOOGLE_MAPS_API_KEY\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [41, 41], "resource": "/Dockerfile.ENV", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_14", "bc_check_id": "BC_DKR_GENERAL_24", "check_name": "Ensure that certificate validation isn't disabled for git by setting the environment variable 'GIT_SSL_NO_VERIFY' to any value", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-git-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_17", "bc_check_id": "BC_DKR_GENERAL_27", "check_name": "Ensure that 'chpasswd' is not used to set or remove passwords", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/bc-docker-2-17", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_9", "bc_check_id": "BC_DKR_GENERAL_19", "check_name": "Ensure that packages with untrusted or missing GPG signatures are not used by dnf, tdnf, or yum via the '--nogpgcheck' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_7", "bc_check_id": "BC_DKR_GENERAL_17", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apk via the '--allow-untrusted' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apk-trusted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_10", "bc_check_id": "BC_DKR_GENERAL_20", "check_name": "Ensure that packages with untrusted or missing signatures are not used by rpm via the '--nodigest', '--nosignature', '--noverify', or '--nofiledigest' options", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-rpm-signed", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_8", "bc_check_id": "BC_DKR_GENERAL_18", "check_name": "Ensure that packages with untrusted or missing signatures are not used by apt-get via the '--allow-unauthenticated' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-authenticated", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_15", "bc_check_id": "BC_DKR_GENERAL_25", "check_name": "Ensure that the yum and dnf package managers are not configured to disable SSL certificate validation via the 'sslverify' configuration option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-yum-ssl", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_4", "bc_check_id": "BC_DKR_GENERAL_14", "check_name": "Ensure that certificate validation isn't disabled with the pip '--trusted-host' option", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-pip-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_21", "check_name": "Ensure that the '--force-yes' option is not used, as it disables signature validation and allows packages to be downgraded which can leave the system in a broken or inconsistent state", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-apt-force", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n", "value": "apt-get update &&     apt-get upgrade -y &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*", "__startline__": 8, "__endline__": 11, "resource_type": "RUN", "hash": "01ebf9e5459243c28bcbf6dc971ad75ad3b4468d1eebeb85f0eb894596cb24ea"}, "evaluated_keys": ["value"]}, "code_block": [[9, "RUN apt-get update && \\\n"], [10, "    apt-get upgrade -y && \\\n"], [11, "    apt-get clean && \\\n"], [12, "    rm -rf /var/lib/apt/lists/*\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [9, 12], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir -r requirements.txt\n", "value": "pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir -r requirements.txt", "__startline__": 15, "__endline__": 16, "resource_type": "RUN", "hash": "99ff5d8eb43598df0f7515a749ec7e2e5c046d49efe0fdc74bbad16f2cd9659e"}, "evaluated_keys": ["value"]}, "code_block": [[16, "RUN pip install --no-cache-dir --upgrade pip && \\\n"], [17, "    pip install --no-cache-dir -r requirements.txt\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [16, 17], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/recommendation-engine/Dockerfile", "config_": {"content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n", "value": "useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "2ef92dfb76e39e1098d9273475b85746224f2ec6635f94c02ce15d64930a01f1"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN useradd -m -u 1001 ecoplate && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/recommendation-engine/Dockerfile", "file_abs_path": "/github/workspace/recommendation-engine/Dockerfile", "repo_file_path": "/recommendation-engine/Dockerfile", "file_line_range": [23, 23], "resource": "/recommendation-engine/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 23, "__endline__": 23, "resource_type": "RUN", "hash": "3d78b992c0f9a0ffd5a10eb887abed4a1174e8965dd3cb6339401aa819b565ee"}, "evaluated_keys": ["value"]}, "code_block": [[24, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [24, 24], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 29, "__endline__": 29, "resource_type": "RUN", "hash": "69370c208320b7a3393a367ff7602851a065d8da886d1dd26ea4e031db5a0596"}, "evaluated_keys": ["value"]}, "code_block": [[30, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [30, 30], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 48, "__endline__": 48, "resource_type": "RUN", "hash": "9f812f09bc71aa7d758fc438e1fe7894687450d1304705b29a6ddc586fe0a5f1"}, "evaluated_keys": ["value"]}, "code_block": [[49, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [49, 49], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun run build\n", "value": "bun run build", "__startline__": 54, "__endline__": 54, "resource_type": "RUN", "hash": "7527b4a4047637f7086e97bd2a70564923d4b1186a3f62ddf1f87d8cfbe9df22"}, "evaluated_keys": ["value"]}, "code_block": [[55, "RUN bun run build\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [55, 55], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install\n", "value": "bun install", "__startline__": 67, "__endline__": 67, "resource_type": "RUN", "hash": "4e7ec575dd81b6e25c818895d4e6ff0a99ca03fcae0ce05eaca38a4d4fc9dd1e"}, "evaluated_keys": ["value"]}, "code_block": [[68, "RUN bun install\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [68, 68], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n", "value": "apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata", "__startline__": 80, "__endline__": 80, "resource_type": "RUN", "hash": "46028916e35252dd6f969e1a64eb3718fcdc6d3e2b024b8526eaac7bf9fb6375"}, "evaluated_keys": ["value"]}, "code_block": [[81, "RUN apk update && apk upgrade --no-cache && apk add --no-cache wget tzdata\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [81, 81], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN addgroup -g 1001 -S ecoplate && \\\n    adduser -S ecoplate -u 1001\n", "value": "addgroup -g 1001 -S ecoplate &&     adduser -S ecoplate -u 1001", "__startline__": 83, "__endline__": 84, "resource_type": "RUN", "hash": "9009ec0fdcb21d993fce4979b275a1091c91cde910c6535e81e1a6b081b2ac03"}, "evaluated_keys": ["value"]}, "code_block": [[84, "RUN addgroup -g 1001 -S ecoplate && \\\n"], [85, "    adduser -S ecoplate -u 1001\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [84, 85], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN bun install --production && \\\n    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n    rm -rf /root/.bun/install/cache\n", "value": "bun install --production &&     rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit &&     grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true &&     rm -rf /root/.bun/install/cache", "__startline__": 96, "__endline__": 99, "resource_type": "RUN", "hash": "496674299e2a21c386245be3baf61369c496fb18aebbcfe614c4f1abdfd285fe"}, "evaluated_keys": ["value"]}, "code_block": [[97, "RUN bun install --production && \\\n"], [98, "    rm -rf node_modules/@esbuild node_modules/esbuild node_modules/drizzle-kit && \\\n"], [99, "    grep -rl \"Go BuildID\" node_modules/ 2>/dev/null | xargs rm -f 2>/dev/null || true && \\\n"], [100, "    rm -rf /root/.bun/install/cache\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [97, 100], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n", "value": "grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true", "__startline__": 111, "__endline__": 111, "resource_type": "RUN", "hash": "dd25d92a997008d119cdb26fadabfea32cff2e1f59f22305328a3a4358d9c8da"}, "evaluated_keys": ["value"]}, "code_block": [[112, "RUN grep -rl \"Go BuildID\" /usr/local/bin/ 2>/dev/null | xargs rm -f 2>/dev/null || true\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [112, 112], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/Dockerfile", "config_": {"content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n", "value": "mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app", "__startline__": 114, "__endline__": 114, "resource_type": "RUN", "hash": "cf21e70539a3281920c9b523677a1af76c5b6a67b70694cd5c02e1cf436cddef"}, "evaluated_keys": ["value"]}, "code_block": [[115, "RUN mkdir -p /app/data /app/public/uploads && chmod +x /app/entrypoint.sh && chown -R ecoplate:ecoplate /app\n"]], "file_path": "/Dockerfile", "file_abs_path": "/github/workspace/Dockerfile", "repo_file_path": "/Dockerfile", "file_line_range": [115, 115], "resource": "/Dockerfile.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN apk add --no-cache --virtual .build-deps \\\n        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n    mkdir -p /tmp/nginx /tmp/headers-more && \\\n    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n    cd /tmp/nginx && \\\n    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n    make modules\n", "value": "apk add --no-cache --virtual .build-deps         gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl &&     NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') &&     curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz &&     curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz &&     mkdir -p /tmp/nginx /tmp/headers-more &&     tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 &&     tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 &&     cd /tmp/nginx &&     ./configure --with-compat --add-dynamic-module=/tmp/headers-more &&     make modules", "__startline__": 3, "__endline__": 13, "resource_type": "RUN", "hash": "bec276335dbbde01d649114d621ef2ebeb06b3e44976e22de96763bce4415e29"}, "evaluated_keys": ["value"]}, "code_block": [[4, "RUN apk add --no-cache --virtual .build-deps \\\n"], [5, "        gcc libc-dev make openssl-dev pcre2-dev zlib-dev linux-headers curl && \\\n"], [6, "    NGINX_VERSION=$(nginx -v 2>&1 | sed 's/nginx version: nginx\\///') && \\\n"], [7, "    curl -fSL \"https://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz\" -o /tmp/nginx.tar.gz && \\\n"], [8, "    curl -fSL \"https://github.com/openresty/headers-more-nginx-module/archive/refs/tags/v0.37.tar.gz\" -o /tmp/headers-more.tar.gz && \\\n"], [9, "    mkdir -p /tmp/nginx /tmp/headers-more && \\\n"], [10, "    tar -xzf /tmp/nginx.tar.gz -C /tmp/nginx --strip-components=1 && \\\n"], [11, "    tar -xzf /tmp/headers-more.tar.gz -C /tmp/headers-more --strip-components=1 && \\\n"], [12, "    cd /tmp/nginx && \\\n"], [13, "    ./configure --with-compat --add-dynamic-module=/tmp/headers-more && \\\n"], [14, "    make modules\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [4, 14], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n", "value": "sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf", "__startline__": 22, "__endline__": 22, "resource_type": "RUN", "hash": "34e4f1b2edb432d01e9d46b6362ff9f578d1ca52a41e2be3d5b4576821b4ccde"}, "evaluated_keys": ["value"]}, "code_block": [[23, "RUN sed -i '1iload_module modules/ngx_http_headers_more_filter_module.so;' /etc/nginx/nginx.conf\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [23, 23], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_DOCKER_3", "bc_check_id": "BC_DKR_GENERAL_13", "check_name": "Ensure that certificate validation isn't disabled with wget", "check_result": {"result": "PASSED", "entity": {"block_name_": "RUN", "block_type_": "resource", "file_path_": "/deploy/Dockerfile.nginx", "config_": {"content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28}, "label_": "resource: RUN", "id_": "RUN", "source_": "Dockerfile", "content": "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n", "value": "chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d &&     touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid &&     mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl", "__startline__": 26, "__endline__": 28, "resource_type": "RUN", "hash": "60a9beb5879f093bcd34047118e31861ecef24f202e98bbc9c3ad07b62bfea18"}, "evaluated_keys": ["value"]}, "code_block": [[27, "RUN chown -R nginx:nginx /var/cache/nginx /var/log/nginx /etc/nginx/conf.d && \\\n"], [28, "    touch /var/run/nginx.pid && chown nginx:nginx /var/run/nginx.pid && \\\n"], [29, "    mkdir -p /etc/nginx/ssl && chown nginx:nginx /etc/nginx/ssl\n"]], "file_path": "/deploy/Dockerfile.nginx", "file_abs_path": "/github/workspace/deploy/Dockerfile.nginx", "repo_file_path": "/deploy/Dockerfile.nginx", "file_line_range": [27, 29], "resource": "/deploy/Dockerfile.nginx.RUN", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-docker-wget-secure", "details": [], "check_len": null, "definition_context_file_path": null}], "failed_checks": [], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 318, "failed": 0, "skipped": 0, "parsing_errors": 0, "resource_count": 3, "checkov_version": "3.2.501"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}